25/10/11 20:54:19 WARN Utils: Your hostname, Eidolon resolves to a loopback address: 127.0.1.1; using 10.255.255.254 instead (on interface lo)
25/10/11 20:54:19 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
25/10/11 20:54:20 INFO SparkContext: Running Spark version 3.5.3
25/10/11 20:54:20 INFO SparkContext: OS info Linux, 6.6.87.2-microsoft-standard-WSL2, amd64
25/10/11 20:54:20 INFO SparkContext: Java version 11.0.28
25/10/11 20:54:20 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/10/11 20:54:20 INFO ResourceUtils: ==============================================================
25/10/11 20:54:20 INFO ResourceUtils: No custom resources configured for spark.driver.
25/10/11 20:54:20 INFO ResourceUtils: ==============================================================
25/10/11 20:54:20 INFO SparkContext: Submitted application: Unified ECommerce Analysis
25/10/11 20:54:20 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/10/11 20:54:20 INFO ResourceProfile: Limiting resource is cpu
25/10/11 20:54:20 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/10/11 20:54:20 INFO SecurityManager: Changing view acls to: arnav
25/10/11 20:54:20 INFO SecurityManager: Changing modify acls to: arnav
25/10/11 20:54:20 INFO SecurityManager: Changing view acls groups to: 
25/10/11 20:54:20 INFO SecurityManager: Changing modify acls groups to: 
25/10/11 20:54:20 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: arnav; groups with view permissions: EMPTY; users with modify permissions: arnav; groups with modify permissions: EMPTY
25/10/11 20:54:21 INFO Utils: Successfully started service 'sparkDriver' on port 41825.
25/10/11 20:54:21 INFO SparkEnv: Registering MapOutputTracker
25/10/11 20:54:21 INFO SparkEnv: Registering BlockManagerMaster
25/10/11 20:54:21 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/10/11 20:54:21 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/10/11 20:54:21 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/10/11 20:54:21 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-54199e90-04ef-410b-8244-5c9d82ea6b93
25/10/11 20:54:21 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
25/10/11 20:54:21 INFO SparkEnv: Registering OutputCommitCoordinator
25/10/11 20:54:21 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/10/11 20:54:21 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/10/11 20:54:21 INFO Executor: Starting executor ID driver on host 10.255.255.254
25/10/11 20:54:21 INFO Executor: OS info Linux, 6.6.87.2-microsoft-standard-WSL2, amd64
25/10/11 20:54:21 INFO Executor: Java version 11.0.28
25/10/11 20:54:21 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/10/11 20:54:21 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@4d770ef7 for default.
25/10/11 20:54:21 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38093.
25/10/11 20:54:21 INFO NettyBlockTransferService: Server created on 10.255.255.254:38093
25/10/11 20:54:21 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/10/11 20:54:21 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 10.255.255.254, 38093, None)
25/10/11 20:54:21 INFO BlockManagerMasterEndpoint: Registering block manager 10.255.255.254:38093 with 434.4 MiB RAM, BlockManagerId(driver, 10.255.255.254, 38093, None)
25/10/11 20:54:21 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 10.255.255.254, 38093, None)
25/10/11 20:54:21 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 10.255.255.254, 38093, None)

====================================================================================================
UNIFIED E-COMMERCE BIG DATA ANALYSIS PIPELINE
====================================================================================================
Start Time: 2025-10-11 20:54:21
Spark Version: 3.5.3

====================================================================================================
PART 1: DATAFRAME API - ENHANCED DATA PROCESSING
====================================================================================================

[PHASE 1.1] Loading and Feature Engineering
25/10/11 20:54:21 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
25/10/11 20:54:22 INFO SharedState: Warehouse path is 'file:/home/arnav/ECommerce_Project/spark-warehouse'.
25/10/11 20:54:23 INFO InMemoryFileIndex: It took 57 ms to list leaf files for 1 paths.
25/10/11 20:54:23 INFO InMemoryFileIndex: It took 4 ms to list leaf files for 1 paths.
25/10/11 20:54:24 INFO FileSourceStrategy: Pushed Filters: 
25/10/11 20:54:24 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
25/10/11 20:54:25 INFO CodeGenerator: Code generated in 160.438262 ms
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 200.2 KiB, free 434.2 MiB)
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 434.2 MiB)
25/10/11 20:54:25 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 10.255.255.254:38093 (size: 34.8 KiB, free: 434.4 MiB)
25/10/11 20:54:25 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
25/10/11 20:54:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:25 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/10/11 20:54:25 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/10/11 20:54:25 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:25 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:25 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:25 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 434.2 MiB)
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 434.2 MiB)
25/10/11 20:54:25 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 10.255.255.254:38093 (size: 6.4 KiB, free: 434.4 MiB)
25/10/11 20:54:25 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:25 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
25/10/11 20:54:25 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (10.255.255.254, executor driver, partition 0, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
25/10/11 20:54:25 INFO CodeGenerator: Code generated in 18.435142 ms
25/10/11 20:54:25 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:25 INFO CodeGenerator: Code generated in 8.847541 ms
25/10/11 20:54:25 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1737 bytes result sent to driver
25/10/11 20:54:25 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 256 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:25 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
25/10/11 20:54:25 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 0.366 s
25/10/11 20:54:25 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
25/10/11 20:54:25 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 0.405494 s
25/10/11 20:54:25 INFO CodeGenerator: Code generated in 10.41685 ms
25/10/11 20:54:25 INFO FileSourceStrategy: Pushed Filters: 
25/10/11 20:54:25 INFO FileSourceStrategy: Post-Scan Filters: 
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 200.2 KiB, free 434.0 MiB)
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 433.9 MiB)
25/10/11 20:54:25 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 10.255.255.254:38093 (size: 34.8 KiB, free: 434.3 MiB)
25/10/11 20:54:25 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
25/10/11 20:54:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:25 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
25/10/11 20:54:25 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 12 output partitions
25/10/11 20:54:25 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:25 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:25 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:25 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 27.8 KiB, free 433.9 MiB)
25/10/11 20:54:25 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 12.8 KiB, free 433.9 MiB)
25/10/11 20:54:25 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 10.255.255.254:38093 (size: 12.8 KiB, free: 434.3 MiB)
25/10/11 20:54:25 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:25 INFO DAGScheduler: Submitting 12 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:25 INFO TaskSchedulerImpl: Adding task set 1.0 with 12 tasks resource profile 0
25/10/11 20:54:25 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (10.255.255.254, executor driver, partition 0, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (10.255.255.254, executor driver, partition 1, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 2.0 in stage 1.0 (TID 3) (10.255.255.254, executor driver, partition 2, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 3.0 in stage 1.0 (TID 4) (10.255.255.254, executor driver, partition 3, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 4.0 in stage 1.0 (TID 5) (10.255.255.254, executor driver, partition 4, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 5.0 in stage 1.0 (TID 6) (10.255.255.254, executor driver, partition 5, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 6.0 in stage 1.0 (TID 7) (10.255.255.254, executor driver, partition 6, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 7.0 in stage 1.0 (TID 8) (10.255.255.254, executor driver, partition 7, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 8.0 in stage 1.0 (TID 9) (10.255.255.254, executor driver, partition 8, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 9.0 in stage 1.0 (TID 10) (10.255.255.254, executor driver, partition 9, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 10.0 in stage 1.0 (TID 11) (10.255.255.254, executor driver, partition 10, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO TaskSetManager: Starting task 11.0 in stage 1.0 (TID 12) (10.255.255.254, executor driver, partition 11, ANY, 9614 bytes) 
25/10/11 20:54:25 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
25/10/11 20:54:25 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
25/10/11 20:54:25 INFO Executor: Running task 2.0 in stage 1.0 (TID 3)
25/10/11 20:54:25 INFO Executor: Running task 3.0 in stage 1.0 (TID 4)
25/10/11 20:54:25 INFO Executor: Running task 5.0 in stage 1.0 (TID 6)
25/10/11 20:54:25 INFO Executor: Running task 4.0 in stage 1.0 (TID 5)
25/10/11 20:54:25 INFO Executor: Running task 6.0 in stage 1.0 (TID 7)
25/10/11 20:54:25 INFO Executor: Running task 7.0 in stage 1.0 (TID 8)
25/10/11 20:54:25 INFO Executor: Running task 9.0 in stage 1.0 (TID 10)
25/10/11 20:54:25 INFO Executor: Running task 8.0 in stage 1.0 (TID 9)
25/10/11 20:54:25 INFO Executor: Running task 11.0 in stage 1.0 (TID 12)
25/10/11 20:54:25 INFO Executor: Running task 10.0 in stage 1.0 (TID 11)
25/10/11 20:54:26 INFO CodeGenerator: Code generated in 7.460598 ms
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:26 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:26 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 10.255.255.254:38093 in memory (size: 6.4 KiB, free: 434.3 MiB)
25/10/11 20:54:26 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 10.255.255.254:38093 in memory (size: 34.8 KiB, free: 434.4 MiB)
25/10/11 20:54:27 INFO Executor: Finished task 11.0 in stage 1.0 (TID 12). 1843 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 11.0 in stage 1.0 (TID 12) in 1733 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:27 INFO Executor: Finished task 8.0 in stage 1.0 (TID 9). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 8.0 in stage 1.0 (TID 9) in 1878 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:27 INFO Executor: Finished task 9.0 in stage 1.0 (TID 10). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 9.0 in stage 1.0 (TID 10) in 1899 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:27 INFO Executor: Finished task 7.0 in stage 1.0 (TID 8). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 7.0 in stage 1.0 (TID 8) in 1909 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:27 INFO Executor: Finished task 2.0 in stage 1.0 (TID 3). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 2.0 in stage 1.0 (TID 3) in 1930 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:27 INFO Executor: Finished task 10.0 in stage 1.0 (TID 11). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 10.0 in stage 1.0 (TID 11) in 1952 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:27 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1966 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:27 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1967 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:27 INFO Executor: Finished task 4.0 in stage 1.0 (TID 5). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO Executor: Finished task 6.0 in stage 1.0 (TID 7). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 4.0 in stage 1.0 (TID 5) in 1975 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:27 INFO TaskSetManager: Finished task 6.0 in stage 1.0 (TID 7) in 1974 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:27 INFO Executor: Finished task 5.0 in stage 1.0 (TID 6). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO Executor: Finished task 3.0 in stage 1.0 (TID 4). 1800 bytes result sent to driver
25/10/11 20:54:27 INFO TaskSetManager: Finished task 3.0 in stage 1.0 (TID 4) in 1985 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:27 INFO TaskSetManager: Finished task 5.0 in stage 1.0 (TID 6) in 1985 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:27 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
25/10/11 20:54:27 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 2.022 s
25/10/11 20:54:27 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
25/10/11 20:54:27 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 2.032024 s
25/10/11 20:54:28 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
25/10/11 20:54:28 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#24),isnotnull(product_id#19)
25/10/11 20:54:28 INFO CodeGenerator: Code generated in 20.506867 ms
25/10/11 20:54:28 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 200.1 KiB, free 433.9 MiB)
25/10/11 20:54:28 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.9 MiB)
25/10/11 20:54:28 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:28 INFO SparkContext: Created broadcast 4 from count at NativeMethodAccessorImpl.java:0
25/10/11 20:54:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:28 INFO DAGScheduler: Registering RDD 13 (count at NativeMethodAccessorImpl.java:0) as input to shuffle 0
25/10/11 20:54:28 INFO DAGScheduler: Got map stage job 2 (count at NativeMethodAccessorImpl.java:0) with 12 output partitions
25/10/11 20:54:28 INFO DAGScheduler: Final stage: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:28 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:28 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:28 INFO DAGScheduler: Submitting ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:28 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 19.0 KiB, free 433.9 MiB)
25/10/11 20:54:28 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 9.2 KiB, free 433.9 MiB)
25/10/11 20:54:28 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 10.255.255.254:38093 (size: 9.2 KiB, free: 434.3 MiB)
25/10/11 20:54:28 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:28 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 2 (MapPartitionsRDD[13] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:28 INFO TaskSchedulerImpl: Adding task set 2.0 with 12 tasks resource profile 0
25/10/11 20:54:28 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 13) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 14) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 2.0 in stage 2.0 (TID 15) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 3.0 in stage 2.0 (TID 16) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 4.0 in stage 2.0 (TID 17) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 5.0 in stage 2.0 (TID 18) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 6.0 in stage 2.0 (TID 19) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 7.0 in stage 2.0 (TID 20) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 8.0 in stage 2.0 (TID 21) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 9.0 in stage 2.0 (TID 22) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 10.0 in stage 2.0 (TID 23) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO TaskSetManager: Starting task 11.0 in stage 2.0 (TID 24) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:28 INFO Executor: Running task 0.0 in stage 2.0 (TID 13)
25/10/11 20:54:28 INFO Executor: Running task 5.0 in stage 2.0 (TID 18)
25/10/11 20:54:28 INFO Executor: Running task 11.0 in stage 2.0 (TID 24)
25/10/11 20:54:28 INFO Executor: Running task 10.0 in stage 2.0 (TID 23)
25/10/11 20:54:28 INFO Executor: Running task 8.0 in stage 2.0 (TID 21)
25/10/11 20:54:28 INFO Executor: Running task 6.0 in stage 2.0 (TID 19)
25/10/11 20:54:28 INFO Executor: Running task 1.0 in stage 2.0 (TID 14)
25/10/11 20:54:28 INFO Executor: Running task 3.0 in stage 2.0 (TID 16)
25/10/11 20:54:28 INFO Executor: Running task 7.0 in stage 2.0 (TID 20)
25/10/11 20:54:28 INFO Executor: Running task 2.0 in stage 2.0 (TID 15)
25/10/11 20:54:28 INFO Executor: Running task 4.0 in stage 2.0 (TID 17)
25/10/11 20:54:28 INFO Executor: Running task 9.0 in stage 2.0 (TID 22)
25/10/11 20:54:28 INFO CodeGenerator: Code generated in 10.161851 ms
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:28 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:28 INFO CodeGenerator: Code generated in 10.130148 ms
25/10/11 20:54:28 INFO CodeGenerator: Code generated in 7.678923 ms
25/10/11 20:54:28 INFO CodeGenerator: Code generated in 3.748344 ms
25/10/11 20:54:28 INFO Executor: Finished task 11.0 in stage 2.0 (TID 24). 2072 bytes result sent to driver
25/10/11 20:54:28 INFO TaskSetManager: Finished task 11.0 in stage 2.0 (TID 24) in 629 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:28 INFO Executor: Finished task 4.0 in stage 2.0 (TID 17). 2029 bytes result sent to driver
25/10/11 20:54:28 INFO TaskSetManager: Finished task 4.0 in stage 2.0 (TID 17) in 662 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:28 INFO Executor: Finished task 5.0 in stage 2.0 (TID 18). 2029 bytes result sent to driver
25/10/11 20:54:28 INFO TaskSetManager: Finished task 5.0 in stage 2.0 (TID 18) in 676 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:28 INFO Executor: Finished task 6.0 in stage 2.0 (TID 19). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 6.0 in stage 2.0 (TID 19) in 683 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:29 INFO Executor: Finished task 7.0 in stage 2.0 (TID 20). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO Executor: Finished task 8.0 in stage 2.0 (TID 21). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO Executor: Finished task 2.0 in stage 2.0 (TID 15). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 8.0 in stage 2.0 (TID 21) in 690 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:29 INFO Executor: Finished task 10.0 in stage 2.0 (TID 23). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 7.0 in stage 2.0 (TID 20) in 692 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:29 INFO TaskSetManager: Finished task 2.0 in stage 2.0 (TID 15) in 695 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:29 INFO Executor: Finished task 9.0 in stage 2.0 (TID 22). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 10.0 in stage 2.0 (TID 23) in 693 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:29 INFO Executor: Finished task 1.0 in stage 2.0 (TID 14). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO Executor: Finished task 3.0 in stage 2.0 (TID 16). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 9.0 in stage 2.0 (TID 22) in 694 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:29 INFO TaskSetManager: Finished task 3.0 in stage 2.0 (TID 16) in 698 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:29 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 14) in 699 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:29 INFO Executor: Finished task 0.0 in stage 2.0 (TID 13). 2029 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 13) in 701 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:29 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool 
25/10/11 20:54:29 INFO DAGScheduler: ShuffleMapStage 2 (count at NativeMethodAccessorImpl.java:0) finished in 0.715 s
25/10/11 20:54:29 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:29 INFO DAGScheduler: running: Set()
25/10/11 20:54:29 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:29 INFO DAGScheduler: failed: Set()
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 7.205888 ms
25/10/11 20:54:29 INFO SparkContext: Starting job: count at NativeMethodAccessorImpl.java:0
25/10/11 20:54:29 INFO DAGScheduler: Got job 3 (count at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/10/11 20:54:29 INFO DAGScheduler: Final stage: ResultStage 4 (count at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:29 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 3)
25/10/11 20:54:29 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:29 INFO DAGScheduler: Submitting ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 12.5 KiB, free 433.9 MiB)
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 433.9 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 10.255.255.254:38093 (size: 5.9 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:29 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 4 (MapPartitionsRDD[16] at count at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:29 INFO TaskSchedulerImpl: Adding task set 4.0 with 1 tasks resource profile 0
25/10/11 20:54:29 INFO TaskSetManager: Starting task 0.0 in stage 4.0 (TID 25) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:29 INFO Executor: Running task 0.0 in stage 4.0 (TID 25)
25/10/11 20:54:29 INFO ShuffleBlockFetcherIterator: Getting 12 (720.0 B) non-empty blocks including 12 (720.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:29 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 13 ms
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 14.531227 ms
25/10/11 20:54:29 INFO Executor: Finished task 0.0 in stage 4.0 (TID 25). 3995 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 0.0 in stage 4.0 (TID 25) in 85 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:29 INFO TaskSchedulerImpl: Removed TaskSet 4.0, whose tasks have all completed, from pool 
25/10/11 20:54:29 INFO DAGScheduler: ResultStage 4 (count at NativeMethodAccessorImpl.java:0) finished in 0.094 s
25/10/11 20:54:29 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:29 INFO TaskSchedulerImpl: Killing all running tasks in stage 4: Stage finished
25/10/11 20:54:29 INFO DAGScheduler: Job 3 finished: count at NativeMethodAccessorImpl.java:0, took 0.103145 s
  > Records Loaded: 999,999
  > Enhanced Features Added: time_segment, is_weekend, price_category

====================================================================================================
PART 2: DATAFRAME API - BEHAVIORAL METRICS
====================================================================================================

[PHASE 2.1] Conversion Funnel Analysis
25/10/11 20:54:29 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
25/10/11 20:54:29 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#24),isnotnull(product_id#19)
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 59.750574 ms
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 200.1 KiB, free 433.7 MiB)
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.6 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO SparkContext: Created broadcast 7 from collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75
25/10/11 20:54:29 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:29 INFO DAGScheduler: Registering RDD 20 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) as input to shuffle 1
25/10/11 20:54:29 INFO DAGScheduler: Got map stage job 4 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) with 12 output partitions
25/10/11 20:54:29 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75)
25/10/11 20:54:29 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:29 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:29 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[20] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75), which has no missing parents
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 41.2 KiB, free 433.6 MiB)
25/10/11 20:54:29 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 19.3 KiB, free 433.6 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 10.255.255.254:38093 (size: 19.3 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:29 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 10.255.255.254:38093 in memory (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[20] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:29 INFO TaskSchedulerImpl: Adding task set 5.0 with 12 tasks resource profile 0
25/10/11 20:54:29 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 26) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 27) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 2.0 in stage 5.0 (TID 28) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 3.0 in stage 5.0 (TID 29) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 4.0 in stage 5.0 (TID 30) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 5.0 in stage 5.0 (TID 31) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 6.0 in stage 5.0 (TID 32) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 7.0 in stage 5.0 (TID 33) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 8.0 in stage 5.0 (TID 34) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 9.0 in stage 5.0 (TID 35) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 10.0 in stage 5.0 (TID 36) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO TaskSetManager: Starting task 11.0 in stage 5.0 (TID 37) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:29 INFO Executor: Running task 0.0 in stage 5.0 (TID 26)
25/10/11 20:54:29 INFO Executor: Running task 3.0 in stage 5.0 (TID 29)
25/10/11 20:54:29 INFO Executor: Running task 7.0 in stage 5.0 (TID 33)
25/10/11 20:54:29 INFO Executor: Running task 6.0 in stage 5.0 (TID 32)
25/10/11 20:54:29 INFO Executor: Running task 8.0 in stage 5.0 (TID 34)
25/10/11 20:54:29 INFO Executor: Running task 10.0 in stage 5.0 (TID 36)
25/10/11 20:54:29 INFO Executor: Running task 11.0 in stage 5.0 (TID 37)
25/10/11 20:54:29 INFO Executor: Running task 1.0 in stage 5.0 (TID 27)
25/10/11 20:54:29 INFO Executor: Running task 9.0 in stage 5.0 (TID 35)
25/10/11 20:54:29 INFO Executor: Running task 4.0 in stage 5.0 (TID 30)
25/10/11 20:54:29 INFO Executor: Running task 2.0 in stage 5.0 (TID 28)
25/10/11 20:54:29 INFO Executor: Running task 5.0 in stage 5.0 (TID 31)
25/10/11 20:54:29 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 10.255.255.254:38093 in memory (size: 9.2 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 10.255.255.254:38093 in memory (size: 12.8 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Removed broadcast_2_piece0 on 10.255.255.254:38093 in memory (size: 34.8 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 10.255.255.254:38093 in memory (size: 5.9 KiB, free: 434.3 MiB)
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 53.389118 ms
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 10.260873 ms
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 3.862691 ms
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 4.881149 ms
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:29 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 9.950698 ms
25/10/11 20:54:29 INFO CodeGenerator: Code generated in 4.549844 ms
25/10/11 20:54:29 INFO Executor: Finished task 11.0 in stage 5.0 (TID 37). 2823 bytes result sent to driver
25/10/11 20:54:29 INFO TaskSetManager: Finished task 11.0 in stage 5.0 (TID 37) in 544 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:30 INFO Executor: Finished task 9.0 in stage 5.0 (TID 35). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 9.0 in stage 5.0 (TID 35) in 549 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:30 INFO Executor: Finished task 0.0 in stage 5.0 (TID 26). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 26) in 561 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:30 INFO Executor: Finished task 8.0 in stage 5.0 (TID 34). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO Executor: Finished task 6.0 in stage 5.0 (TID 32). 2866 bytes result sent to driver
25/10/11 20:54:30 INFO Executor: Finished task 1.0 in stage 5.0 (TID 27). 2866 bytes result sent to driver
25/10/11 20:54:30 INFO Executor: Finished task 2.0 in stage 5.0 (TID 28). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 8.0 in stage 5.0 (TID 34) in 564 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:30 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 27) in 567 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:30 INFO Executor: Finished task 3.0 in stage 5.0 (TID 29). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 2.0 in stage 5.0 (TID 28) in 568 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:30 INFO TaskSetManager: Finished task 6.0 in stage 5.0 (TID 32) in 569 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:30 INFO TaskSetManager: Finished task 3.0 in stage 5.0 (TID 29) in 570 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:30 INFO Executor: Finished task 10.0 in stage 5.0 (TID 36). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 10.0 in stage 5.0 (TID 36) in 571 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:30 INFO Executor: Finished task 5.0 in stage 5.0 (TID 31). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 5.0 in stage 5.0 (TID 31) in 575 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:30 INFO Executor: Finished task 4.0 in stage 5.0 (TID 30). 2866 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 4.0 in stage 5.0 (TID 30) in 594 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:30 INFO Executor: Finished task 7.0 in stage 5.0 (TID 33). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 7.0 in stage 5.0 (TID 33) in 597 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:30 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
25/10/11 20:54:30 INFO DAGScheduler: ShuffleMapStage 5 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) finished in 0.626 s
25/10/11 20:54:30 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:30 INFO DAGScheduler: running: Set()
25/10/11 20:54:30 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:30 INFO DAGScheduler: failed: Set()
25/10/11 20:54:30 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:30 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 15.502861 ms
25/10/11 20:54:30 INFO SparkContext: Starting job: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75
25/10/11 20:54:30 INFO DAGScheduler: Got job 5 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) with 1 output partitions
25/10/11 20:54:30 INFO DAGScheduler: Final stage: ResultStage 7 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75)
25/10/11 20:54:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 6)
25/10/11 20:54:30 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:30 INFO DAGScheduler: Submitting ResultStage 7 (MapPartitionsRDD[23] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75), which has no missing parents
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 42.5 KiB, free 434.1 MiB)
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 20.3 KiB, free 434.1 MiB)
25/10/11 20:54:30 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 10.255.255.254:38093 (size: 20.3 KiB, free: 434.3 MiB)
25/10/11 20:54:30 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 7 (MapPartitionsRDD[23] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:30 INFO TaskSchedulerImpl: Adding task set 7.0 with 1 tasks resource profile 0
25/10/11 20:54:30 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 38) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:30 INFO Executor: Running task 0.0 in stage 7.0 (TID 38)
25/10/11 20:54:30 INFO ShuffleBlockFetcherIterator: Getting 12 (2.6 KiB) non-empty blocks including 12 (2.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:30 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 8.707047 ms
25/10/11 20:54:30 INFO Executor: Finished task 0.0 in stage 7.0 (TID 38). 5225 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 38) in 32 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:30 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool 
25/10/11 20:54:30 INFO DAGScheduler: ResultStage 7 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75) finished in 0.040 s
25/10/11 20:54:30 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 7: Stage finished
25/10/11 20:54:30 INFO DAGScheduler: Job 5 finished: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:75, took 0.046272 s
  Views: 968,512 -> Carts: 14,639 (1.51%)
  -> Purchases: 16,848 (115.09%)
  > Overall Conversion: 1.74%

[PHASE 2.2] Time-Based Performance
25/10/11 20:54:30 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
25/10/11 20:54:30 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#24),isnotnull(product_id#19)
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 22.404718 ms
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 200.1 KiB, free 433.9 MiB)
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.8 MiB)
25/10/11 20:54:30 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:30 INFO SparkContext: Created broadcast 10 from pivot at NativeMethodAccessorImpl.java:0
25/10/11 20:54:30 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:30 INFO DAGScheduler: Registering RDD 27 (pivot at NativeMethodAccessorImpl.java:0) as input to shuffle 2
25/10/11 20:54:30 INFO DAGScheduler: Got map stage job 6 (pivot at NativeMethodAccessorImpl.java:0) with 12 output partitions
25/10/11 20:54:30 INFO DAGScheduler: Final stage: ShuffleMapStage 8 (pivot at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:30 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:30 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:30 INFO DAGScheduler: Submitting ShuffleMapStage 8 (MapPartitionsRDD[27] at pivot at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 39.0 KiB, free 433.8 MiB)
25/10/11 20:54:30 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 433.8 MiB)
25/10/11 20:54:30 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 10.255.255.254:38093 (size: 18.2 KiB, free: 434.3 MiB)
25/10/11 20:54:30 INFO SparkContext: Created broadcast 11 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:30 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 8 (MapPartitionsRDD[27] at pivot at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:30 INFO TaskSchedulerImpl: Adding task set 8.0 with 12 tasks resource profile 0
25/10/11 20:54:30 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 39) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 40) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 2.0 in stage 8.0 (TID 41) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 3.0 in stage 8.0 (TID 42) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 4.0 in stage 8.0 (TID 43) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 5.0 in stage 8.0 (TID 44) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 6.0 in stage 8.0 (TID 45) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 7.0 in stage 8.0 (TID 46) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 8.0 in stage 8.0 (TID 47) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 9.0 in stage 8.0 (TID 48) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 10.0 in stage 8.0 (TID 49) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO TaskSetManager: Starting task 11.0 in stage 8.0 (TID 50) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:30 INFO Executor: Running task 11.0 in stage 8.0 (TID 50)
25/10/11 20:54:30 INFO Executor: Running task 3.0 in stage 8.0 (TID 42)
25/10/11 20:54:30 INFO Executor: Running task 8.0 in stage 8.0 (TID 47)
25/10/11 20:54:30 INFO Executor: Running task 7.0 in stage 8.0 (TID 46)
25/10/11 20:54:30 INFO Executor: Running task 0.0 in stage 8.0 (TID 39)
25/10/11 20:54:30 INFO Executor: Running task 4.0 in stage 8.0 (TID 43)
25/10/11 20:54:30 INFO Executor: Running task 2.0 in stage 8.0 (TID 41)
25/10/11 20:54:30 INFO Executor: Running task 9.0 in stage 8.0 (TID 48)
25/10/11 20:54:30 INFO Executor: Running task 10.0 in stage 8.0 (TID 49)
25/10/11 20:54:30 INFO Executor: Running task 6.0 in stage 8.0 (TID 45)
25/10/11 20:54:30 INFO Executor: Running task 1.0 in stage 8.0 (TID 40)
25/10/11 20:54:30 INFO Executor: Running task 5.0 in stage 8.0 (TID 44)
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 20.514523 ms
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 3.089885 ms
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:30 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:30 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 10.255.255.254:38093 in memory (size: 19.3 KiB, free: 434.3 MiB)
25/10/11 20:54:30 INFO BlockManagerInfo: Removed broadcast_9_piece0 on 10.255.255.254:38093 in memory (size: 20.3 KiB, free: 434.3 MiB)
25/10/11 20:54:30 INFO Executor: Finished task 11.0 in stage 8.0 (TID 50). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 11.0 in stage 8.0 (TID 50) in 329 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:30 INFO Executor: Finished task 0.0 in stage 8.0 (TID 39). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 39) in 350 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:30 INFO Executor: Finished task 6.0 in stage 8.0 (TID 45). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO Executor: Finished task 1.0 in stage 8.0 (TID 40). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 6.0 in stage 8.0 (TID 45) in 403 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:30 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 40) in 405 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:30 INFO Executor: Finished task 10.0 in stage 8.0 (TID 49). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 10.0 in stage 8.0 (TID 49) in 406 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:30 INFO Executor: Finished task 2.0 in stage 8.0 (TID 41). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 2.0 in stage 8.0 (TID 41) in 414 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:30 INFO Executor: Finished task 9.0 in stage 8.0 (TID 48). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 9.0 in stage 8.0 (TID 48) in 423 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:30 INFO Executor: Finished task 3.0 in stage 8.0 (TID 42). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 3.0 in stage 8.0 (TID 42) in 428 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:30 INFO Executor: Finished task 5.0 in stage 8.0 (TID 44). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO Executor: Finished task 8.0 in stage 8.0 (TID 47). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 5.0 in stage 8.0 (TID 44) in 437 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:30 INFO TaskSetManager: Finished task 8.0 in stage 8.0 (TID 47) in 437 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:30 INFO Executor: Finished task 4.0 in stage 8.0 (TID 43). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 4.0 in stage 8.0 (TID 43) in 451 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:30 INFO Executor: Finished task 7.0 in stage 8.0 (TID 46). 2823 bytes result sent to driver
25/10/11 20:54:30 INFO TaskSetManager: Finished task 7.0 in stage 8.0 (TID 46) in 470 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:30 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
25/10/11 20:54:30 INFO DAGScheduler: ShuffleMapStage 8 (pivot at NativeMethodAccessorImpl.java:0) finished in 0.480 s
25/10/11 20:54:30 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:30 INFO DAGScheduler: running: Set()
25/10/11 20:54:30 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:30 INFO DAGScheduler: failed: Set()
25/10/11 20:54:30 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 20.468428 ms
25/10/11 20:54:30 INFO CodeGenerator: Code generated in 7.952421 ms
25/10/11 20:54:31 INFO SparkContext: Starting job: pivot at NativeMethodAccessorImpl.java:0
25/10/11 20:54:31 INFO DAGScheduler: Got job 7 (pivot at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/10/11 20:54:31 INFO DAGScheduler: Final stage: ResultStage 10 (pivot at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:31 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 9)
25/10/11 20:54:31 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:31 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[32] at pivot at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.2 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.2 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 10.255.255.254:38093 (size: 21.2 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:31 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[32] at pivot at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:31 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
25/10/11 20:54:31 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 51) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:31 INFO Executor: Running task 0.0 in stage 10.0 (TID 51)
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Getting 12 (2.5 KiB) non-empty blocks including 12 (2.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 26.932561 ms
25/10/11 20:54:31 INFO Executor: Finished task 0.0 in stage 10.0 (TID 51). 5404 bytes result sent to driver
25/10/11 20:54:31 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 51) in 60 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:31 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
25/10/11 20:54:31 INFO DAGScheduler: ResultStage 10 (pivot at NativeMethodAccessorImpl.java:0) finished in 0.070 s
25/10/11 20:54:31 INFO DAGScheduler: Job 7 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:31 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
25/10/11 20:54:31 INFO DAGScheduler: Job 7 finished: pivot at NativeMethodAccessorImpl.java:0, took 0.075306 s
25/10/11 20:54:31 INFO DAGScheduler: Registering RDD 33 (pivot at NativeMethodAccessorImpl.java:0) as input to shuffle 3
25/10/11 20:54:31 INFO DAGScheduler: Got map stage job 8 (pivot at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/10/11 20:54:31 INFO DAGScheduler: Final stage: ShuffleMapStage 12 (pivot at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:31 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 11)
25/10/11 20:54:31 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:31 INFO DAGScheduler: Submitting ShuffleMapStage 12 (MapPartitionsRDD[33] at pivot at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 46.7 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 21.6 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 10.255.255.254:38093 (size: 21.6 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Removed broadcast_12_piece0 on 10.255.255.254:38093 in memory (size: 21.2 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:31 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 12 (MapPartitionsRDD[33] at pivot at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:31 INFO TaskSchedulerImpl: Adding task set 12.0 with 1 tasks resource profile 0
25/10/11 20:54:31 INFO TaskSetManager: Starting task 0.0 in stage 12.0 (TID 52) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8988 bytes) 
25/10/11 20:54:31 INFO Executor: Running task 0.0 in stage 12.0 (TID 52)
25/10/11 20:54:31 INFO BlockManagerInfo: Removed broadcast_11_piece0 on 10.255.255.254:38093 in memory (size: 18.2 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 9.299367 ms
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Getting 12 (2.5 KiB) non-empty blocks including 12 (2.5 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:31 INFO Executor: Finished task 0.0 in stage 12.0 (TID 52). 5319 bytes result sent to driver
25/10/11 20:54:31 INFO TaskSetManager: Finished task 0.0 in stage 12.0 (TID 52) in 80 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:31 INFO TaskSchedulerImpl: Removed TaskSet 12.0, whose tasks have all completed, from pool 
25/10/11 20:54:31 INFO DAGScheduler: ShuffleMapStage 12 (pivot at NativeMethodAccessorImpl.java:0) finished in 0.108 s
25/10/11 20:54:31 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:31 INFO DAGScheduler: running: Set()
25/10/11 20:54:31 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:31 INFO DAGScheduler: failed: Set()
25/10/11 20:54:31 INFO ShufflePartitionsUtil: For shuffle(3), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 7.793886 ms
25/10/11 20:54:31 INFO SparkContext: Starting job: pivot at NativeMethodAccessorImpl.java:0
25/10/11 20:54:31 INFO DAGScheduler: Got job 9 (pivot at NativeMethodAccessorImpl.java:0) with 1 output partitions
25/10/11 20:54:31 INFO DAGScheduler: Final stage: ResultStage 15 (pivot at NativeMethodAccessorImpl.java:0)
25/10/11 20:54:31 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 14)
25/10/11 20:54:31 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:31 INFO DAGScheduler: Submitting ResultStage 15 (MapPartitionsRDD[36] at pivot at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 40.5 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 18.9 KiB, free 433.8 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 10.255.255.254:38093 (size: 18.9 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO SparkContext: Created broadcast 14 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:31 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 15 (MapPartitionsRDD[36] at pivot at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:31 INFO TaskSchedulerImpl: Adding task set 15.0 with 1 tasks resource profile 0
25/10/11 20:54:31 INFO TaskSetManager: Starting task 0.0 in stage 15.0 (TID 53) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:31 INFO Executor: Running task 0.0 in stage 15.0 (TID 53)
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Getting 1 (216.0 B) non-empty blocks including 1 (216.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:31 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 6.590021 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 8.52585 ms
25/10/11 20:54:31 INFO Executor: Finished task 0.0 in stage 15.0 (TID 53). 6674 bytes result sent to driver
25/10/11 20:54:31 INFO TaskSetManager: Finished task 0.0 in stage 15.0 (TID 53) in 49 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:31 INFO TaskSchedulerImpl: Removed TaskSet 15.0, whose tasks have all completed, from pool 
25/10/11 20:54:31 INFO DAGScheduler: ResultStage 15 (pivot at NativeMethodAccessorImpl.java:0) finished in 0.057 s
25/10/11 20:54:31 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:31 INFO TaskSchedulerImpl: Killing all running tasks in stage 15: Stage finished
25/10/11 20:54:31 INFO DAGScheduler: Job 9 finished: pivot at NativeMethodAccessorImpl.java:0, took 0.063133 s
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 6.479408 ms
25/10/11 20:54:31 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
25/10/11 20:54:31 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#24),isnotnull(product_id#19)
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 26.583034 ms
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 200.1 KiB, free 433.6 MiB)
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.6 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO SparkContext: Created broadcast 15 from first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88
25/10/11 20:54:31 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:31 INFO DAGScheduler: Registering RDD 40 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) as input to shuffle 4
25/10/11 20:54:31 INFO DAGScheduler: Got map stage job 10 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) with 12 output partitions
25/10/11 20:54:31 INFO DAGScheduler: Final stage: ShuffleMapStage 16 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88)
25/10/11 20:54:31 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:31 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:31 INFO DAGScheduler: Submitting ShuffleMapStage 16 (MapPartitionsRDD[40] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88), which has no missing parents
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_16 stored as values in memory (estimated size 48.1 KiB, free 433.5 MiB)
25/10/11 20:54:31 INFO MemoryStore: Block broadcast_16_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 433.5 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Added broadcast_16_piece0 in memory on 10.255.255.254:38093 (size: 21.8 KiB, free: 434.2 MiB)
25/10/11 20:54:31 INFO SparkContext: Created broadcast 16 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:31 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 16 (MapPartitionsRDD[40] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:31 INFO TaskSchedulerImpl: Adding task set 16.0 with 12 tasks resource profile 0
25/10/11 20:54:31 INFO TaskSetManager: Starting task 0.0 in stage 16.0 (TID 54) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 1.0 in stage 16.0 (TID 55) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 2.0 in stage 16.0 (TID 56) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 3.0 in stage 16.0 (TID 57) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 4.0 in stage 16.0 (TID 58) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 5.0 in stage 16.0 (TID 59) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 6.0 in stage 16.0 (TID 60) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 7.0 in stage 16.0 (TID 61) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 8.0 in stage 16.0 (TID 62) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 9.0 in stage 16.0 (TID 63) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 10.0 in stage 16.0 (TID 64) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO TaskSetManager: Starting task 11.0 in stage 16.0 (TID 65) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:31 INFO Executor: Running task 1.0 in stage 16.0 (TID 55)
25/10/11 20:54:31 INFO Executor: Running task 0.0 in stage 16.0 (TID 54)
25/10/11 20:54:31 INFO Executor: Running task 2.0 in stage 16.0 (TID 56)
25/10/11 20:54:31 INFO Executor: Running task 5.0 in stage 16.0 (TID 59)
25/10/11 20:54:31 INFO Executor: Running task 3.0 in stage 16.0 (TID 57)
25/10/11 20:54:31 INFO Executor: Running task 4.0 in stage 16.0 (TID 58)
25/10/11 20:54:31 INFO Executor: Running task 7.0 in stage 16.0 (TID 61)
25/10/11 20:54:31 INFO Executor: Running task 6.0 in stage 16.0 (TID 60)
25/10/11 20:54:31 INFO Executor: Running task 8.0 in stage 16.0 (TID 62)
25/10/11 20:54:31 INFO Executor: Running task 11.0 in stage 16.0 (TID 65)
25/10/11 20:54:31 INFO Executor: Running task 9.0 in stage 16.0 (TID 63)
25/10/11 20:54:31 INFO Executor: Running task 10.0 in stage 16.0 (TID 64)
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 28.468826 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 4.951348 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 6.308103 ms
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:31 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 5.206238 ms
25/10/11 20:54:31 INFO CodeGenerator: Code generated in 2.63011 ms
25/10/11 20:54:31 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 10.255.255.254:38093 in memory (size: 34.7 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Removed broadcast_14_piece0 on 10.255.255.254:38093 in memory (size: 18.9 KiB, free: 434.3 MiB)
25/10/11 20:54:31 INFO BlockManagerInfo: Removed broadcast_13_piece0 on 10.255.255.254:38093 in memory (size: 21.6 KiB, free: 434.3 MiB)
25/10/11 20:54:32 INFO Executor: Finished task 11.0 in stage 16.0 (TID 65). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 11.0 in stage 16.0 (TID 65) in 704 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:32 INFO Executor: Finished task 6.0 in stage 16.0 (TID 60). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 6.0 in stage 16.0 (TID 60) in 772 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:32 INFO Executor: Finished task 2.0 in stage 16.0 (TID 56). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 2.0 in stage 16.0 (TID 56) in 813 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:32 INFO Executor: Finished task 4.0 in stage 16.0 (TID 58). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 4.0 in stage 16.0 (TID 58) in 856 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:32 INFO Executor: Finished task 9.0 in stage 16.0 (TID 63). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 9.0 in stage 16.0 (TID 63) in 867 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:32 INFO Executor: Finished task 8.0 in stage 16.0 (TID 62). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 8.0 in stage 16.0 (TID 62) in 876 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:32 INFO Executor: Finished task 5.0 in stage 16.0 (TID 59). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 5.0 in stage 16.0 (TID 59) in 886 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:32 INFO Executor: Finished task 7.0 in stage 16.0 (TID 61). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 7.0 in stage 16.0 (TID 61) in 889 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:32 INFO Executor: Finished task 1.0 in stage 16.0 (TID 55). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 1.0 in stage 16.0 (TID 55) in 896 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:32 INFO Executor: Finished task 0.0 in stage 16.0 (TID 54). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 0.0 in stage 16.0 (TID 54) in 906 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:32 INFO Executor: Finished task 10.0 in stage 16.0 (TID 64). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 10.0 in stage 16.0 (TID 64) in 909 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:32 INFO Executor: Finished task 3.0 in stage 16.0 (TID 57). 2823 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 3.0 in stage 16.0 (TID 57) in 939 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:32 INFO TaskSchedulerImpl: Removed TaskSet 16.0, whose tasks have all completed, from pool 
25/10/11 20:54:32 INFO DAGScheduler: ShuffleMapStage 16 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) finished in 0.947 s
25/10/11 20:54:32 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:32 INFO DAGScheduler: running: Set()
25/10/11 20:54:32 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:32 INFO DAGScheduler: failed: Set()
25/10/11 20:54:32 INFO ShufflePartitionsUtil: For shuffle(4), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:32 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:32 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 19.474145 ms
25/10/11 20:54:32 INFO DAGScheduler: Registering RDD 44 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) as input to shuffle 5
25/10/11 20:54:32 INFO DAGScheduler: Got map stage job 11 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) with 1 output partitions
25/10/11 20:54:32 INFO DAGScheduler: Final stage: ShuffleMapStage 18 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88)
25/10/11 20:54:32 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 17)
25/10/11 20:54:32 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:32 INFO DAGScheduler: Submitting ShuffleMapStage 18 (MapPartitionsRDD[44] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88), which has no missing parents
25/10/11 20:54:32 INFO MemoryStore: Block broadcast_17 stored as values in memory (estimated size 69.8 KiB, free 433.8 MiB)
25/10/11 20:54:32 INFO MemoryStore: Block broadcast_17_piece0 stored as bytes in memory (estimated size 28.4 KiB, free 433.8 MiB)
25/10/11 20:54:32 INFO BlockManagerInfo: Added broadcast_17_piece0 in memory on 10.255.255.254:38093 (size: 28.4 KiB, free: 434.3 MiB)
25/10/11 20:54:32 INFO SparkContext: Created broadcast 17 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:32 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 18 (MapPartitionsRDD[44] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:32 INFO TaskSchedulerImpl: Adding task set 18.0 with 1 tasks resource profile 0
25/10/11 20:54:32 INFO TaskSetManager: Starting task 0.0 in stage 18.0 (TID 66) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8988 bytes) 
25/10/11 20:54:32 INFO Executor: Running task 0.0 in stage 18.0 (TID 66)
25/10/11 20:54:32 INFO ShuffleBlockFetcherIterator: Getting 12 (4.0 KiB) non-empty blocks including 12 (4.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:32 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 30.044271 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 3.561024 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 2.966321 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 5.567041 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 4.486007 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 3.537981 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 5.851661 ms
25/10/11 20:54:32 INFO Executor: Finished task 0.0 in stage 18.0 (TID 66). 6527 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 0.0 in stage 18.0 (TID 66) in 142 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:32 INFO TaskSchedulerImpl: Removed TaskSet 18.0, whose tasks have all completed, from pool 
25/10/11 20:54:32 INFO DAGScheduler: ShuffleMapStage 18 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) finished in 0.149 s
25/10/11 20:54:32 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:32 INFO DAGScheduler: running: Set()
25/10/11 20:54:32 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:32 INFO DAGScheduler: failed: Set()
25/10/11 20:54:32 INFO ShufflePartitionsUtil: For shuffle(5), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 5.319986 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 8.858317 ms
25/10/11 20:54:32 INFO SparkContext: Starting job: first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88
25/10/11 20:54:32 INFO DAGScheduler: Got job 12 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) with 1 output partitions
25/10/11 20:54:32 INFO DAGScheduler: Final stage: ResultStage 21 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88)
25/10/11 20:54:32 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 20)
25/10/11 20:54:32 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:32 INFO DAGScheduler: Submitting ResultStage 21 (MapPartitionsRDD[49] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88), which has no missing parents
25/10/11 20:54:32 INFO MemoryStore: Block broadcast_18 stored as values in memory (estimated size 61.6 KiB, free 433.7 MiB)
25/10/11 20:54:32 INFO MemoryStore: Block broadcast_18_piece0 stored as bytes in memory (estimated size 26.1 KiB, free 433.7 MiB)
25/10/11 20:54:32 INFO BlockManagerInfo: Added broadcast_18_piece0 in memory on 10.255.255.254:38093 (size: 26.1 KiB, free: 434.3 MiB)
25/10/11 20:54:32 INFO SparkContext: Created broadcast 18 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 21 (MapPartitionsRDD[49] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:32 INFO TaskSchedulerImpl: Adding task set 21.0 with 1 tasks resource profile 0
25/10/11 20:54:32 INFO TaskSetManager: Starting task 0.0 in stage 21.0 (TID 67) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:32 INFO Executor: Running task 0.0 in stage 21.0 (TID 67)
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 8.801558 ms
25/10/11 20:54:32 INFO ShuffleBlockFetcherIterator: Getting 1 (273.0 B) non-empty blocks including 1 (273.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:32 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 5.018094 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 7.927814 ms
25/10/11 20:54:32 INFO CodeGenerator: Code generated in 7.351249 ms
25/10/11 20:54:32 INFO Executor: Finished task 0.0 in stage 21.0 (TID 67). 7830 bytes result sent to driver
25/10/11 20:54:32 INFO TaskSetManager: Finished task 0.0 in stage 21.0 (TID 67) in 73 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:32 INFO TaskSchedulerImpl: Removed TaskSet 21.0, whose tasks have all completed, from pool 
25/10/11 20:54:32 INFO DAGScheduler: ResultStage 21 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88) finished in 0.080 s
25/10/11 20:54:32 INFO DAGScheduler: Job 12 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 21: Stage finished
25/10/11 20:54:32 INFO DAGScheduler: Job 12 finished: first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:88, took 0.085142 s
  > Best Conversion Period: MORNING (2.09%)

[PHASE 2.3] Price Sensitivity Analysis
  Revenue by Category:
25/10/11 20:54:32 INFO FileSourceStrategy: Pushed Filters: IsNotNull(event_type),IsNotNull(user_id),IsNotNull(product_id),EqualTo(event_type,purchase)
25/10/11 20:54:32 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(event_type#18),isnotnull(user_id#24),isnotnull(product_id#19),(event_type#18 = purchase)
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 14.701125 ms
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_19 stored as values in memory (estimated size 200.1 KiB, free 433.5 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_19_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.5 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_19_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 19 from collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99
25/10/11 20:54:33 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:33 INFO DAGScheduler: Registering RDD 53 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) as input to shuffle 6
25/10/11 20:54:33 INFO DAGScheduler: Got map stage job 13 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) with 12 output partitions
25/10/11 20:54:33 INFO DAGScheduler: Final stage: ShuffleMapStage 22 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99)
25/10/11 20:54:33 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:33 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:33 INFO DAGScheduler: Submitting ShuffleMapStage 22 (MapPartitionsRDD[53] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99), which has no missing parents
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_20 stored as values in memory (estimated size 47.7 KiB, free 433.4 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_20_piece0 stored as bytes in memory (estimated size 21.9 KiB, free 433.4 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_20_piece0 in memory on 10.255.255.254:38093 (size: 21.9 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 20 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:33 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 22 (MapPartitionsRDD[53] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:33 INFO TaskSchedulerImpl: Adding task set 22.0 with 12 tasks resource profile 0
25/10/11 20:54:33 INFO TaskSetManager: Starting task 0.0 in stage 22.0 (TID 68) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 1.0 in stage 22.0 (TID 69) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 2.0 in stage 22.0 (TID 70) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 3.0 in stage 22.0 (TID 71) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 4.0 in stage 22.0 (TID 72) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 5.0 in stage 22.0 (TID 73) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 6.0 in stage 22.0 (TID 74) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 7.0 in stage 22.0 (TID 75) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 8.0 in stage 22.0 (TID 76) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 9.0 in stage 22.0 (TID 77) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 10.0 in stage 22.0 (TID 78) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO TaskSetManager: Starting task 11.0 in stage 22.0 (TID 79) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:33 INFO Executor: Running task 3.0 in stage 22.0 (TID 71)
25/10/11 20:54:33 INFO Executor: Running task 2.0 in stage 22.0 (TID 70)
25/10/11 20:54:33 INFO Executor: Running task 0.0 in stage 22.0 (TID 68)
25/10/11 20:54:33 INFO Executor: Running task 1.0 in stage 22.0 (TID 69)
25/10/11 20:54:33 INFO Executor: Running task 7.0 in stage 22.0 (TID 75)
25/10/11 20:54:33 INFO Executor: Running task 10.0 in stage 22.0 (TID 78)
25/10/11 20:54:33 INFO Executor: Running task 6.0 in stage 22.0 (TID 74)
25/10/11 20:54:33 INFO Executor: Running task 5.0 in stage 22.0 (TID 73)
25/10/11 20:54:33 INFO Executor: Running task 9.0 in stage 22.0 (TID 77)
25/10/11 20:54:33 INFO Executor: Running task 11.0 in stage 22.0 (TID 79)
25/10/11 20:54:33 INFO Executor: Running task 8.0 in stage 22.0 (TID 76)
25/10/11 20:54:33 INFO Executor: Running task 4.0 in stage 22.0 (TID 72)
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 18.787642 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 5.132902 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 3.371161 ms
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 32.208455 ms
25/10/11 20:54:33 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:33 INFO BlockManagerInfo: Removed broadcast_18_piece0 on 10.255.255.254:38093 in memory (size: 26.1 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Removed broadcast_17_piece0 on 10.255.255.254:38093 in memory (size: 28.4 KiB, free: 434.3 MiB)
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 7.918636 ms
25/10/11 20:54:33 INFO Executor: Finished task 11.0 in stage 22.0 (TID 79). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 11.0 in stage 22.0 (TID 79) in 351 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:33 INFO Executor: Finished task 7.0 in stage 22.0 (TID 75). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 7.0 in stage 22.0 (TID 75) in 388 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:33 INFO Executor: Finished task 0.0 in stage 22.0 (TID 68). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO Executor: Finished task 10.0 in stage 22.0 (TID 78). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 0.0 in stage 22.0 (TID 68) in 449 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:33 INFO Executor: Finished task 1.0 in stage 22.0 (TID 69). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 10.0 in stage 22.0 (TID 78) in 451 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:33 INFO TaskSetManager: Finished task 1.0 in stage 22.0 (TID 69) in 457 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:33 INFO Executor: Finished task 4.0 in stage 22.0 (TID 72). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 4.0 in stage 22.0 (TID 72) in 489 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:33 INFO Executor: Finished task 6.0 in stage 22.0 (TID 74). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 6.0 in stage 22.0 (TID 74) in 506 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:33 INFO Executor: Finished task 9.0 in stage 22.0 (TID 77). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 9.0 in stage 22.0 (TID 77) in 524 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:33 INFO Executor: Finished task 2.0 in stage 22.0 (TID 70). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 2.0 in stage 22.0 (TID 70) in 528 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:33 INFO Executor: Finished task 5.0 in stage 22.0 (TID 73). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 5.0 in stage 22.0 (TID 73) in 530 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:33 INFO Executor: Finished task 8.0 in stage 22.0 (TID 76). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 8.0 in stage 22.0 (TID 76) in 531 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:33 INFO Executor: Finished task 3.0 in stage 22.0 (TID 71). 2823 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 3.0 in stage 22.0 (TID 71) in 538 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:33 INFO TaskSchedulerImpl: Removed TaskSet 22.0, whose tasks have all completed, from pool 
25/10/11 20:54:33 INFO DAGScheduler: ShuffleMapStage 22 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) finished in 0.548 s
25/10/11 20:54:33 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:33 INFO DAGScheduler: running: Set()
25/10/11 20:54:33 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:33 INFO DAGScheduler: failed: Set()
25/10/11 20:54:33 INFO ShufflePartitionsUtil: For shuffle(6), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:33 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 15.099116 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 8.623749 ms
25/10/11 20:54:33 INFO SparkContext: Starting job: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99
25/10/11 20:54:33 INFO DAGScheduler: Got job 14 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) with 1 output partitions
25/10/11 20:54:33 INFO DAGScheduler: Final stage: ResultStage 24 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99)
25/10/11 20:54:33 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 23)
25/10/11 20:54:33 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:33 INFO DAGScheduler: Submitting ResultStage 24 (MapPartitionsRDD[58] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99), which has no missing parents
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_21 stored as values in memory (estimated size 52.1 KiB, free 433.5 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_21_piece0 stored as bytes in memory (estimated size 23.9 KiB, free 433.5 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_21_piece0 in memory on 10.255.255.254:38093 (size: 23.9 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 21 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:33 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 24 (MapPartitionsRDD[58] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:33 INFO TaskSchedulerImpl: Adding task set 24.0 with 1 tasks resource profile 0
25/10/11 20:54:33 INFO TaskSetManager: Starting task 0.0 in stage 24.0 (TID 80) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:33 INFO Executor: Running task 0.0 in stage 24.0 (TID 80)
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Getting 12 (3.1 KiB) non-empty blocks including 12 (3.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 11.069688 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 3.380521 ms
25/10/11 20:54:33 INFO Executor: Finished task 0.0 in stage 24.0 (TID 80). 5380 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 0.0 in stage 24.0 (TID 80) in 37 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:33 INFO TaskSchedulerImpl: Removed TaskSet 24.0, whose tasks have all completed, from pool 
25/10/11 20:54:33 INFO DAGScheduler: ResultStage 24 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) finished in 0.046 s
25/10/11 20:54:33 INFO DAGScheduler: Job 14 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:33 INFO TaskSchedulerImpl: Killing all running tasks in stage 24: Stage finished
25/10/11 20:54:33 INFO DAGScheduler: Job 14 finished: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99, took 0.052208 s
25/10/11 20:54:33 INFO DAGScheduler: Registering RDD 59 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) as input to shuffle 7
25/10/11 20:54:33 INFO DAGScheduler: Got map stage job 15 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) with 1 output partitions
25/10/11 20:54:33 INFO DAGScheduler: Final stage: ShuffleMapStage 26 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99)
25/10/11 20:54:33 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 25)
25/10/11 20:54:33 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:33 INFO DAGScheduler: Submitting ShuffleMapStage 26 (MapPartitionsRDD[59] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99), which has no missing parents
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_22 stored as values in memory (estimated size 52.4 KiB, free 433.5 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_22_piece0 stored as bytes in memory (estimated size 24.3 KiB, free 433.4 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_22_piece0 in memory on 10.255.255.254:38093 (size: 24.3 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 22 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:33 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 26 (MapPartitionsRDD[59] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:33 INFO TaskSchedulerImpl: Adding task set 26.0 with 1 tasks resource profile 0
25/10/11 20:54:33 INFO TaskSetManager: Starting task 0.0 in stage 26.0 (TID 81) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8988 bytes) 
25/10/11 20:54:33 INFO Executor: Running task 0.0 in stage 26.0 (TID 81)
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 5.38544 ms
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Getting 12 (3.1 KiB) non-empty blocks including 12 (3.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:33 INFO Executor: Finished task 0.0 in stage 26.0 (TID 81). 5319 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 0.0 in stage 26.0 (TID 81) in 25 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:33 INFO TaskSchedulerImpl: Removed TaskSet 26.0, whose tasks have all completed, from pool 
25/10/11 20:54:33 INFO DAGScheduler: ShuffleMapStage 26 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) finished in 0.034 s
25/10/11 20:54:33 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:33 INFO DAGScheduler: running: Set()
25/10/11 20:54:33 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:33 INFO DAGScheduler: failed: Set()
25/10/11 20:54:33 INFO ShufflePartitionsUtil: For shuffle(7), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:33 INFO SparkContext: Starting job: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99
25/10/11 20:54:33 INFO DAGScheduler: Got job 16 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) with 1 output partitions
25/10/11 20:54:33 INFO DAGScheduler: Final stage: ResultStage 29 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99)
25/10/11 20:54:33 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 28)
25/10/11 20:54:33 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:33 INFO DAGScheduler: Submitting ResultStage 29 (MapPartitionsRDD[62] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99), which has no missing parents
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_23 stored as values in memory (estimated size 48.9 KiB, free 433.4 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_23_piece0 stored as bytes in memory (estimated size 23.0 KiB, free 433.4 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_23_piece0 in memory on 10.255.255.254:38093 (size: 23.0 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 23 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:33 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 29 (MapPartitionsRDD[62] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:33 INFO TaskSchedulerImpl: Adding task set 29.0 with 1 tasks resource profile 0
25/10/11 20:54:33 INFO TaskSetManager: Starting task 0.0 in stage 29.0 (TID 82) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:33 INFO Executor: Running task 0.0 in stage 29.0 (TID 82)
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Getting 1 (273.0 B) non-empty blocks including 1 (273.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:33 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 9.778094 ms
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 8.888958 ms
25/10/11 20:54:33 INFO Executor: Finished task 0.0 in stage 29.0 (TID 82). 6735 bytes result sent to driver
25/10/11 20:54:33 INFO TaskSetManager: Finished task 0.0 in stage 29.0 (TID 82) in 38 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:33 INFO TaskSchedulerImpl: Removed TaskSet 29.0, whose tasks have all completed, from pool 
25/10/11 20:54:33 INFO DAGScheduler: ResultStage 29 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99) finished in 0.047 s
25/10/11 20:54:33 INFO DAGScheduler: Job 16 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:33 INFO TaskSchedulerImpl: Killing all running tasks in stage 29: Stage finished
25/10/11 20:54:33 INFO DAGScheduler: Job 16 finished: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:99, took 0.052083 s
    premium     : $   4,555,418 (7,882 sales)
    mid-range   : $     807,591 (6,380 sales)
    budget      : $      72,597 (2,586 sales)

[PHASE 2.4] Top Performers
25/10/11 20:54:33 INFO FileSourceStrategy: Pushed Filters: IsNotNull(event_type),IsNotNull(user_id),IsNotNull(product_id),EqualTo(event_type,purchase)
25/10/11 20:54:33 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(event_type#18),isnotnull(user_id#24),isnotnull(product_id#19),(event_type#18 = purchase)
25/10/11 20:54:33 INFO CodeGenerator: Code generated in 19.599324 ms
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_24 stored as values in memory (estimated size 200.1 KiB, free 433.2 MiB)
25/10/11 20:54:33 INFO MemoryStore: Block broadcast_24_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.1 MiB)
25/10/11 20:54:33 INFO BlockManagerInfo: Added broadcast_24_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:33 INFO SparkContext: Created broadcast 24 from first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109
25/10/11 20:54:33 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:34 INFO DAGScheduler: Registering RDD 66 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) as input to shuffle 8
25/10/11 20:54:34 INFO DAGScheduler: Got map stage job 17 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) with 12 output partitions
25/10/11 20:54:34 INFO DAGScheduler: Final stage: ShuffleMapStage 30 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109)
25/10/11 20:54:34 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:34 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:34 INFO DAGScheduler: Submitting ShuffleMapStage 30 (MapPartitionsRDD[66] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109), which has no missing parents
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_25 stored as values in memory (estimated size 46.5 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_25_piece0 stored as bytes in memory (estimated size 21.4 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Added broadcast_25_piece0 in memory on 10.255.255.254:38093 (size: 21.4 KiB, free: 434.1 MiB)
25/10/11 20:54:34 INFO SparkContext: Created broadcast 25 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:34 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 30 (MapPartitionsRDD[66] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:34 INFO TaskSchedulerImpl: Adding task set 30.0 with 12 tasks resource profile 0
25/10/11 20:54:34 INFO TaskSetManager: Starting task 0.0 in stage 30.0 (TID 83) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 1.0 in stage 30.0 (TID 84) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 2.0 in stage 30.0 (TID 85) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 3.0 in stage 30.0 (TID 86) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 4.0 in stage 30.0 (TID 87) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 5.0 in stage 30.0 (TID 88) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 6.0 in stage 30.0 (TID 89) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 7.0 in stage 30.0 (TID 90) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 8.0 in stage 30.0 (TID 91) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 9.0 in stage 30.0 (TID 92) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 10.0 in stage 30.0 (TID 93) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO TaskSetManager: Starting task 11.0 in stage 30.0 (TID 94) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:34 INFO Executor: Running task 3.0 in stage 30.0 (TID 86)
25/10/11 20:54:34 INFO Executor: Running task 1.0 in stage 30.0 (TID 84)
25/10/11 20:54:34 INFO Executor: Running task 4.0 in stage 30.0 (TID 87)
25/10/11 20:54:34 INFO Executor: Running task 5.0 in stage 30.0 (TID 88)
25/10/11 20:54:34 INFO Executor: Running task 2.0 in stage 30.0 (TID 85)
25/10/11 20:54:34 INFO Executor: Running task 6.0 in stage 30.0 (TID 89)
25/10/11 20:54:34 INFO Executor: Running task 10.0 in stage 30.0 (TID 93)
25/10/11 20:54:34 INFO Executor: Running task 7.0 in stage 30.0 (TID 90)
25/10/11 20:54:34 INFO Executor: Running task 0.0 in stage 30.0 (TID 83)
25/10/11 20:54:34 INFO Executor: Running task 11.0 in stage 30.0 (TID 94)
25/10/11 20:54:34 INFO Executor: Running task 8.0 in stage 30.0 (TID 91)
25/10/11 20:54:34 INFO Executor: Running task 9.0 in stage 30.0 (TID 92)
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 27.739237 ms
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 11.78645 ms
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 16.89466 ms
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 6.806395 ms
25/10/11 20:54:34 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 5.823997 ms
25/10/11 20:54:34 INFO BlockManagerInfo: Removed broadcast_22_piece0 on 10.255.255.254:38093 in memory (size: 24.3 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Removed broadcast_21_piece0 on 10.255.255.254:38093 in memory (size: 23.9 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Removed broadcast_16_piece0 on 10.255.255.254:38093 in memory (size: 21.8 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Removed broadcast_23_piece0 on 10.255.255.254:38093 in memory (size: 23.0 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Removed broadcast_20_piece0 on 10.255.255.254:38093 in memory (size: 21.9 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO Executor: Finished task 11.0 in stage 30.0 (TID 94). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 11.0 in stage 30.0 (TID 94) in 419 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:34 INFO Executor: Finished task 10.0 in stage 30.0 (TID 93). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 10.0 in stage 30.0 (TID 93) in 523 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:34 INFO Executor: Finished task 9.0 in stage 30.0 (TID 92). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 9.0 in stage 30.0 (TID 92) in 552 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:34 INFO Executor: Finished task 5.0 in stage 30.0 (TID 88). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO Executor: Finished task 7.0 in stage 30.0 (TID 90). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO Executor: Finished task 8.0 in stage 30.0 (TID 91). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 5.0 in stage 30.0 (TID 88) in 559 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:34 INFO Executor: Finished task 0.0 in stage 30.0 (TID 83). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 7.0 in stage 30.0 (TID 90) in 559 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:34 INFO TaskSetManager: Finished task 8.0 in stage 30.0 (TID 91) in 560 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:34 INFO TaskSetManager: Finished task 0.0 in stage 30.0 (TID 83) in 561 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:34 INFO Executor: Finished task 1.0 in stage 30.0 (TID 84). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO Executor: Finished task 6.0 in stage 30.0 (TID 89). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 1.0 in stage 30.0 (TID 84) in 564 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:34 INFO Executor: Finished task 4.0 in stage 30.0 (TID 87). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 6.0 in stage 30.0 (TID 89) in 564 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:34 INFO TaskSetManager: Finished task 4.0 in stage 30.0 (TID 87) in 565 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:34 INFO Executor: Finished task 3.0 in stage 30.0 (TID 86). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 3.0 in stage 30.0 (TID 86) in 566 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:34 INFO Executor: Finished task 2.0 in stage 30.0 (TID 85). 2823 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 2.0 in stage 30.0 (TID 85) in 567 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:34 INFO TaskSchedulerImpl: Removed TaskSet 30.0, whose tasks have all completed, from pool 
25/10/11 20:54:34 INFO DAGScheduler: ShuffleMapStage 30 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) finished in 0.575 s
25/10/11 20:54:34 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:34 INFO DAGScheduler: running: Set()
25/10/11 20:54:34 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:34 INFO DAGScheduler: failed: Set()
25/10/11 20:54:34 INFO ShufflePartitionsUtil: For shuffle(8), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 10.533267 ms
25/10/11 20:54:34 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 11.65159 ms
25/10/11 20:54:34 INFO SparkContext: Starting job: first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109
25/10/11 20:54:34 INFO DAGScheduler: Got job 18 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) with 1 output partitions
25/10/11 20:54:34 INFO DAGScheduler: Final stage: ResultStage 32 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109)
25/10/11 20:54:34 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 31)
25/10/11 20:54:34 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:34 INFO DAGScheduler: Submitting ResultStage 32 (MapPartitionsRDD[70] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109), which has no missing parents
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_26 stored as values in memory (estimated size 51.5 KiB, free 433.4 MiB)
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_26_piece0 stored as bytes in memory (estimated size 23.6 KiB, free 433.3 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Added broadcast_26_piece0 in memory on 10.255.255.254:38093 (size: 23.6 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO SparkContext: Created broadcast 26 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:34 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 32 (MapPartitionsRDD[70] at first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:34 INFO TaskSchedulerImpl: Adding task set 32.0 with 1 tasks resource profile 0
25/10/11 20:54:34 INFO TaskSetManager: Starting task 0.0 in stage 32.0 (TID 95) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:34 INFO Executor: Running task 0.0 in stage 32.0 (TID 95)
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 4.944206 ms
25/10/11 20:54:34 INFO ShuffleBlockFetcherIterator: Getting 12 (142.6 KiB) non-empty blocks including 12 (142.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:34 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 7.965288 ms
25/10/11 20:54:34 INFO Executor: Finished task 0.0 in stage 32.0 (TID 95). 5182 bytes result sent to driver
25/10/11 20:54:34 INFO TaskSetManager: Finished task 0.0 in stage 32.0 (TID 95) in 46 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:34 INFO TaskSchedulerImpl: Removed TaskSet 32.0, whose tasks have all completed, from pool 
25/10/11 20:54:34 INFO DAGScheduler: ResultStage 32 (first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109) finished in 0.056 s
25/10/11 20:54:34 INFO DAGScheduler: Job 18 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:34 INFO TaskSchedulerImpl: Killing all running tasks in stage 32: Stage finished
25/10/11 20:54:34 INFO DAGScheduler: Job 18 finished: first at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:109, took 0.061792 s
  > Leading Brand: apple - $2,717,407 (3,480 sales)

====================================================================================================
PART 3: DATAFRAME API - CUSTOMER SEGMENTATION
====================================================================================================

[PHASE 3.1] RFM Analysis
  Customer Segments:
25/10/11 20:54:34 INFO FileSourceStrategy: Pushed Filters: IsNotNull(event_type),IsNotNull(user_id),IsNotNull(product_id),EqualTo(event_type,purchase)
25/10/11 20:54:34 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(event_type#18),isnotnull(user_id#24),isnotnull(product_id#19),(event_type#18 = purchase)
25/10/11 20:54:34 INFO CodeGenerator: Code generated in 6.612837 ms
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_27 stored as values in memory (estimated size 200.1 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_27_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Added broadcast_27_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO SparkContext: Created broadcast 27 from collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139
25/10/11 20:54:34 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
25/10/11 20:54:34 INFO DAGScheduler: Registering RDD 75 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) as input to shuffle 9
25/10/11 20:54:34 INFO DAGScheduler: Got map stage job 19 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) with 12 output partitions
25/10/11 20:54:34 INFO DAGScheduler: Final stage: ShuffleMapStage 33 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139)
25/10/11 20:54:34 INFO DAGScheduler: Parents of final stage: List()
25/10/11 20:54:34 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:34 INFO DAGScheduler: Submitting ShuffleMapStage 33 (MapPartitionsRDD[75] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139), which has no missing parents
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_28 stored as values in memory (estimated size 38.0 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO MemoryStore: Block broadcast_28_piece0 stored as bytes in memory (estimated size 18.1 KiB, free 433.1 MiB)
25/10/11 20:54:34 INFO BlockManagerInfo: Added broadcast_28_piece0 in memory on 10.255.255.254:38093 (size: 18.1 KiB, free: 434.2 MiB)
25/10/11 20:54:34 INFO SparkContext: Created broadcast 28 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:34 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 33 (MapPartitionsRDD[75] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:34 INFO TaskSchedulerImpl: Adding task set 33.0 with 12 tasks resource profile 0
25/10/11 20:54:35 INFO TaskSetManager: Starting task 0.0 in stage 33.0 (TID 96) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 1.0 in stage 33.0 (TID 97) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 2.0 in stage 33.0 (TID 98) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 3.0 in stage 33.0 (TID 99) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 4.0 in stage 33.0 (TID 100) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 5.0 in stage 33.0 (TID 101) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 6.0 in stage 33.0 (TID 102) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 7.0 in stage 33.0 (TID 103) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 8.0 in stage 33.0 (TID 104) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 9.0 in stage 33.0 (TID 105) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 10.0 in stage 33.0 (TID 106) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO TaskSetManager: Starting task 11.0 in stage 33.0 (TID 107) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:35 INFO Executor: Running task 8.0 in stage 33.0 (TID 104)
25/10/11 20:54:35 INFO Executor: Running task 4.0 in stage 33.0 (TID 100)
25/10/11 20:54:35 INFO Executor: Running task 3.0 in stage 33.0 (TID 99)
25/10/11 20:54:35 INFO Executor: Running task 0.0 in stage 33.0 (TID 96)
25/10/11 20:54:35 INFO Executor: Running task 9.0 in stage 33.0 (TID 105)
25/10/11 20:54:35 INFO Executor: Running task 1.0 in stage 33.0 (TID 97)
25/10/11 20:54:35 INFO Executor: Running task 5.0 in stage 33.0 (TID 101)
25/10/11 20:54:35 INFO Executor: Running task 10.0 in stage 33.0 (TID 106)
25/10/11 20:54:35 INFO Executor: Running task 7.0 in stage 33.0 (TID 103)
25/10/11 20:54:35 INFO Executor: Running task 11.0 in stage 33.0 (TID 107)
25/10/11 20:54:35 INFO Executor: Running task 6.0 in stage 33.0 (TID 102)
25/10/11 20:54:35 INFO Executor: Running task 2.0 in stage 33.0 (TID 98)
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 17.915889 ms
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 3.423495 ms
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 3.241118 ms
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 2.950677 ms
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:35 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 4.495594 ms
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 4.485206 ms
25/10/11 20:54:35 INFO BlockManagerInfo: Removed broadcast_25_piece0 on 10.255.255.254:38093 in memory (size: 21.4 KiB, free: 434.2 MiB)
25/10/11 20:54:35 INFO BlockManagerInfo: Removed broadcast_26_piece0 on 10.255.255.254:38093 in memory (size: 23.6 KiB, free: 434.2 MiB)
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 23.634506 ms
25/10/11 20:54:35 INFO Executor: Finished task 11.0 in stage 33.0 (TID 107). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 11.0 in stage 33.0 (TID 107) in 633 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:35 INFO Executor: Finished task 10.0 in stage 33.0 (TID 106). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO BlockManagerInfo: Removed broadcast_24_piece0 on 10.255.255.254:38093 in memory (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:35 INFO TaskSetManager: Finished task 10.0 in stage 33.0 (TID 106) in 722 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:35 INFO Executor: Finished task 6.0 in stage 33.0 (TID 102). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 6.0 in stage 33.0 (TID 102) in 755 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:35 INFO Executor: Finished task 9.0 in stage 33.0 (TID 105). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 9.0 in stage 33.0 (TID 105) in 760 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:35 INFO Executor: Finished task 1.0 in stage 33.0 (TID 97). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 1.0 in stage 33.0 (TID 97) in 768 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:35 INFO Executor: Finished task 0.0 in stage 33.0 (TID 96). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 0.0 in stage 33.0 (TID 96) in 811 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:35 INFO Executor: Finished task 2.0 in stage 33.0 (TID 98). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 2.0 in stage 33.0 (TID 98) in 814 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:35 INFO Executor: Finished task 4.0 in stage 33.0 (TID 100). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 4.0 in stage 33.0 (TID 100) in 827 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:35 INFO Executor: Finished task 8.0 in stage 33.0 (TID 104). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 8.0 in stage 33.0 (TID 104) in 831 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:35 INFO Executor: Finished task 7.0 in stage 33.0 (TID 103). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 7.0 in stage 33.0 (TID 103) in 839 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:35 INFO Executor: Finished task 3.0 in stage 33.0 (TID 99). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 3.0 in stage 33.0 (TID 99) in 843 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:35 INFO Executor: Finished task 5.0 in stage 33.0 (TID 101). 2630 bytes result sent to driver
25/10/11 20:54:35 INFO TaskSetManager: Finished task 5.0 in stage 33.0 (TID 101) in 865 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:35 INFO TaskSchedulerImpl: Removed TaskSet 33.0, whose tasks have all completed, from pool 
25/10/11 20:54:35 INFO DAGScheduler: ShuffleMapStage 33 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) finished in 0.890 s
25/10/11 20:54:35 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:35 INFO DAGScheduler: running: Set()
25/10/11 20:54:35 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:35 INFO DAGScheduler: failed: Set()
25/10/11 20:54:35 INFO ShufflePartitionsUtil: For shuffle(9), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:35 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 22.475428 ms
25/10/11 20:54:35 INFO CodeGenerator: Code generated in 9.276194 ms
25/10/11 20:54:35 INFO DAGScheduler: Registering RDD 81 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) as input to shuffle 10
25/10/11 20:54:35 INFO DAGScheduler: Got map stage job 20 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) with 1 output partitions
25/10/11 20:54:35 INFO DAGScheduler: Final stage: ShuffleMapStage 35 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139)
25/10/11 20:54:35 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 34)
25/10/11 20:54:35 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:35 INFO DAGScheduler: Submitting ShuffleMapStage 35 (MapPartitionsRDD[81] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139), which has no missing parents
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_29 stored as values in memory (estimated size 94.2 KiB, free 433.3 MiB)
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_29_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 433.3 MiB)
25/10/11 20:54:36 INFO BlockManagerInfo: Added broadcast_29_piece0 in memory on 10.255.255.254:38093 (size: 37.6 KiB, free: 434.2 MiB)
25/10/11 20:54:36 INFO SparkContext: Created broadcast 29 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:36 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 35 (MapPartitionsRDD[81] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:36 INFO TaskSchedulerImpl: Adding task set 35.0 with 1 tasks resource profile 0
25/10/11 20:54:36 INFO TaskSetManager: Starting task 0.0 in stage 35.0 (TID 108) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8988 bytes) 
25/10/11 20:54:36 INFO Executor: Running task 0.0 in stage 35.0 (TID 108)
25/10/11 20:54:36 INFO ShuffleBlockFetcherIterator: Getting 12 (469.1 KiB) non-empty blocks including 12 (469.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:36 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 6.637838 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 3.541664 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 4.06075 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 5.228728 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 4.818148 ms
25/10/11 20:54:36 INFO BlockManagerInfo: Removed broadcast_28_piece0 on 10.255.255.254:38093 in memory (size: 18.1 KiB, free: 434.2 MiB)
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 44.835393 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 5.246251 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 4.080133 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 4.751612 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 4.896171 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 3.657489 ms
25/10/11 20:54:36 INFO Executor: Finished task 0.0 in stage 35.0 (TID 108). 6527 bytes result sent to driver
25/10/11 20:54:36 INFO TaskSetManager: Finished task 0.0 in stage 35.0 (TID 108) in 263 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:36 INFO TaskSchedulerImpl: Removed TaskSet 35.0, whose tasks have all completed, from pool 
25/10/11 20:54:36 INFO DAGScheduler: ShuffleMapStage 35 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) finished in 0.275 s
25/10/11 20:54:36 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:36 INFO DAGScheduler: running: Set()
25/10/11 20:54:36 INFO DAGScheduler: waiting: Set()
25/10/11 20:54:36 INFO DAGScheduler: failed: Set()
25/10/11 20:54:36 INFO ShufflePartitionsUtil: For shuffle(10), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
25/10/11 20:54:36 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 11.503452 ms
25/10/11 20:54:36 INFO SparkContext: Starting job: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139
25/10/11 20:54:36 INFO DAGScheduler: Got job 21 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) with 1 output partitions
25/10/11 20:54:36 INFO DAGScheduler: Final stage: ResultStage 38 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139)
25/10/11 20:54:36 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 37)
25/10/11 20:54:36 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:36 INFO DAGScheduler: Submitting ResultStage 38 (MapPartitionsRDD[84] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139), which has no missing parents
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_30 stored as values in memory (estimated size 71.8 KiB, free 433.3 MiB)
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_30_piece0 stored as bytes in memory (estimated size 31.2 KiB, free 433.3 MiB)
25/10/11 20:54:36 INFO BlockManagerInfo: Added broadcast_30_piece0 in memory on 10.255.255.254:38093 (size: 31.2 KiB, free: 434.2 MiB)
25/10/11 20:54:36 INFO SparkContext: Created broadcast 30 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:36 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 38 (MapPartitionsRDD[84] at collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:36 INFO TaskSchedulerImpl: Adding task set 38.0 with 1 tasks resource profile 0
25/10/11 20:54:36 INFO TaskSetManager: Starting task 0.0 in stage 38.0 (TID 109) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8999 bytes) 
25/10/11 20:54:36 INFO Executor: Running task 0.0 in stage 38.0 (TID 109)
25/10/11 20:54:36 INFO ShuffleBlockFetcherIterator: Getting 1 (88.0 B) non-empty blocks including 1 (88.0 B) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:36 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 6.808207 ms
25/10/11 20:54:36 INFO Executor: Finished task 0.0 in stage 38.0 (TID 109). 7782 bytes result sent to driver
25/10/11 20:54:36 INFO TaskSetManager: Finished task 0.0 in stage 38.0 (TID 109) in 19 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:36 INFO TaskSchedulerImpl: Removed TaskSet 38.0, whose tasks have all completed, from pool 
25/10/11 20:54:36 INFO DAGScheduler: ResultStage 38 (collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139) finished in 0.026 s
25/10/11 20:54:36 INFO DAGScheduler: Job 21 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:36 INFO TaskSchedulerImpl: Killing all running tasks in stage 38: Stage finished
25/10/11 20:54:36 INFO DAGScheduler: Job 21 finished: collect at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:139, took 0.031135 s
    At-Risk   : 12,452 customers (avg $306.72)

====================================================================================================
PART 4: RDD API - TRANSFORMATIONS & ACTIONS
====================================================================================================

[PHASE 4.1] Converting to RDD for Low-Level Operations
25/10/11 20:54:36 INFO FileSourceStrategy: Pushed Filters: IsNotNull(user_id),IsNotNull(product_id)
25/10/11 20:54:36 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(user_id#24),isnotnull(product_id#19)
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 17.88317 ms
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_31 stored as values in memory (estimated size 200.1 KiB, free 433.1 MiB)
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_31_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 433.0 MiB)
25/10/11 20:54:36 INFO BlockManagerInfo: Added broadcast_31_piece0 in memory on 10.255.255.254:38093 (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:36 INFO SparkContext: Created broadcast 31 from javaToPython at NativeMethodAccessorImpl.java:0
25/10/11 20:54:36 INFO FileSourceScanExec: Planning scan with bin packing, max size: 11480368 bytes, open cost is considered as scanning 4194304 bytes.
  > RDD Partitions: 8
  > Storage Level: MEMORY_AND_DISK

[PHASE 4.2] RDD Transformations (12 Operations)
25/10/11 20:54:36 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158
25/10/11 20:54:36 INFO DAGScheduler: Registering RDD 92 (coalesce at NativeMethodAccessorImpl.java:0) as input to shuffle 11
25/10/11 20:54:36 INFO DAGScheduler: Got job 22 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) with 8 output partitions
25/10/11 20:54:36 INFO DAGScheduler: Final stage: ResultStage 40 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158)
25/10/11 20:54:36 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 39)
25/10/11 20:54:36 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 39)
25/10/11 20:54:36 INFO DAGScheduler: Submitting ShuffleMapStage 39 (MapPartitionsRDD[92] at coalesce at NativeMethodAccessorImpl.java:0), which has no missing parents
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_32 stored as values in memory (estimated size 34.2 KiB, free 433.0 MiB)
25/10/11 20:54:36 INFO MemoryStore: Block broadcast_32_piece0 stored as bytes in memory (estimated size 14.8 KiB, free 433.0 MiB)
25/10/11 20:54:36 INFO BlockManagerInfo: Added broadcast_32_piece0 in memory on 10.255.255.254:38093 (size: 14.8 KiB, free: 434.1 MiB)
25/10/11 20:54:36 INFO SparkContext: Created broadcast 32 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:36 INFO DAGScheduler: Submitting 12 missing tasks from ShuffleMapStage 39 (MapPartitionsRDD[92] at coalesce at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11))
25/10/11 20:54:36 INFO TaskSchedulerImpl: Adding task set 39.0 with 12 tasks resource profile 0
25/10/11 20:54:36 INFO TaskSetManager: Starting task 0.0 in stage 39.0 (TID 110) (10.255.255.254, executor driver, partition 0, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 1.0 in stage 39.0 (TID 111) (10.255.255.254, executor driver, partition 1, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 2.0 in stage 39.0 (TID 112) (10.255.255.254, executor driver, partition 2, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 3.0 in stage 39.0 (TID 113) (10.255.255.254, executor driver, partition 3, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 4.0 in stage 39.0 (TID 114) (10.255.255.254, executor driver, partition 4, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 5.0 in stage 39.0 (TID 115) (10.255.255.254, executor driver, partition 5, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 6.0 in stage 39.0 (TID 116) (10.255.255.254, executor driver, partition 6, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 7.0 in stage 39.0 (TID 117) (10.255.255.254, executor driver, partition 7, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 8.0 in stage 39.0 (TID 118) (10.255.255.254, executor driver, partition 8, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 9.0 in stage 39.0 (TID 119) (10.255.255.254, executor driver, partition 9, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 10.0 in stage 39.0 (TID 120) (10.255.255.254, executor driver, partition 10, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO TaskSetManager: Starting task 11.0 in stage 39.0 (TID 121) (10.255.255.254, executor driver, partition 11, ANY, 9603 bytes) 
25/10/11 20:54:36 INFO Executor: Running task 7.0 in stage 39.0 (TID 117)
25/10/11 20:54:36 INFO Executor: Running task 0.0 in stage 39.0 (TID 110)
25/10/11 20:54:36 INFO Executor: Running task 11.0 in stage 39.0 (TID 121)
25/10/11 20:54:36 INFO Executor: Running task 10.0 in stage 39.0 (TID 120)
25/10/11 20:54:36 INFO Executor: Running task 2.0 in stage 39.0 (TID 112)
25/10/11 20:54:36 INFO Executor: Running task 1.0 in stage 39.0 (TID 111)
25/10/11 20:54:36 INFO Executor: Running task 5.0 in stage 39.0 (TID 115)
25/10/11 20:54:36 INFO Executor: Running task 9.0 in stage 39.0 (TID 119)
25/10/11 20:54:36 INFO Executor: Running task 8.0 in stage 39.0 (TID 118)
25/10/11 20:54:36 INFO Executor: Running task 6.0 in stage 39.0 (TID 116)
25/10/11 20:54:36 INFO Executor: Running task 3.0 in stage 39.0 (TID 113)
25/10/11 20:54:36 INFO Executor: Running task 4.0 in stage 39.0 (TID 114)
25/10/11 20:54:36 INFO CodeGenerator: Code generated in 23.307728 ms
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 68882208-80362576, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 22960736-34441104, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 91842944-103323312, partition values: [empty row]
25/10/11 20:54:37 INFO CodeGenerator: Code generated in 16.465801 ms
25/10/11 20:54:37 INFO CodeGenerator: Code generated in 2.526177 ms
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 11480368-22960736, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 126284048-133570116, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 103323312-114803680, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 57401840-68882208, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 80362576-91842944, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 114803680-126284048, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 45921472-57401840, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 34441104-45921472, partition values: [empty row]
25/10/11 20:54:37 INFO FileScanRDD: Reading File path: hdfs://localhost:9000/ecommerce/ecommerce_sample.csv, range: 0-11480368, partition values: [empty row]
25/10/11 20:54:37 INFO BlockManagerInfo: Removed broadcast_30_piece0 on 10.255.255.254:38093 in memory (size: 31.2 KiB, free: 434.2 MiB)
25/10/11 20:54:37 INFO BlockManagerInfo: Removed broadcast_29_piece0 on 10.255.255.254:38093 in memory (size: 37.6 KiB, free: 434.2 MiB)
25/10/11 20:54:38 INFO BlockManagerInfo: Removed broadcast_15_piece0 on 10.255.255.254:38093 in memory (size: 34.7 KiB, free: 434.2 MiB)
25/10/11 20:54:41 INFO PythonRunner: Times: total = 4684, boot = 627, init = 236, finish = 3821
25/10/11 20:54:41 INFO Executor: Finished task 11.0 in stage 39.0 (TID 121). 2010 bytes result sent to driver
25/10/11 20:54:41 INFO TaskSetManager: Finished task 11.0 in stage 39.0 (TID 121) in 4885 ms on 10.255.255.254 (executor driver) (1/12)
25/10/11 20:54:41 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 48393
25/10/11 20:54:42 INFO PythonRunner: Times: total = 6006, boot = 712, init = 302, finish = 4992
25/10/11 20:54:42 INFO Executor: Finished task 4.0 in stage 39.0 (TID 114). 2010 bytes result sent to driver
25/10/11 20:54:42 INFO PythonRunner: Times: total = 6198, boot = 585, init = 265, finish = 5348
25/10/11 20:54:42 INFO TaskSetManager: Finished task 4.0 in stage 39.0 (TID 114) in 6271 ms on 10.255.255.254 (executor driver) (2/12)
25/10/11 20:54:42 INFO PythonRunner: Times: total = 6181, boot = 611, init = 256, finish = 5314
25/10/11 20:54:42 INFO Executor: Finished task 6.0 in stage 39.0 (TID 116). 2010 bytes result sent to driver
25/10/11 20:54:42 INFO TaskSetManager: Finished task 6.0 in stage 39.0 (TID 116) in 6299 ms on 10.255.255.254 (executor driver) (3/12)
25/10/11 20:54:42 INFO Executor: Finished task 1.0 in stage 39.0 (TID 111). 2053 bytes result sent to driver
25/10/11 20:54:42 INFO TaskSetManager: Finished task 1.0 in stage 39.0 (TID 111) in 6331 ms on 10.255.255.254 (executor driver) (4/12)
25/10/11 20:54:42 INFO PythonRunner: Times: total = 6276, boot = 740, init = 274, finish = 5262
25/10/11 20:54:42 INFO Executor: Finished task 3.0 in stage 39.0 (TID 113). 2010 bytes result sent to driver
25/10/11 20:54:42 INFO TaskSetManager: Finished task 3.0 in stage 39.0 (TID 113) in 6357 ms on 10.255.255.254 (executor driver) (5/12)
25/10/11 20:54:42 INFO PythonRunner: Times: total = 6266, boot = 704, init = 162, finish = 5400
25/10/11 20:54:42 INFO Executor: Finished task 9.0 in stage 39.0 (TID 119). 2010 bytes result sent to driver
25/10/11 20:54:42 INFO TaskSetManager: Finished task 9.0 in stage 39.0 (TID 119) in 6382 ms on 10.255.255.254 (executor driver) (6/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6390, boot = 698, init = 296, finish = 5396
25/10/11 20:54:43 INFO Executor: Finished task 0.0 in stage 39.0 (TID 110). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 0.0 in stage 39.0 (TID 110) in 6491 ms on 10.255.255.254 (executor driver) (7/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6532, boot = 687, init = 163, finish = 5682
25/10/11 20:54:43 INFO Executor: Finished task 7.0 in stage 39.0 (TID 117). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 7.0 in stage 39.0 (TID 117) in 6600 ms on 10.255.255.254 (executor driver) (8/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6544, boot = 664, init = 199, finish = 5681
25/10/11 20:54:43 INFO Executor: Finished task 5.0 in stage 39.0 (TID 115). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 5.0 in stage 39.0 (TID 115) in 6615 ms on 10.255.255.254 (executor driver) (9/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6564, boot = 657, init = 217, finish = 5690
25/10/11 20:54:43 INFO Executor: Finished task 10.0 in stage 39.0 (TID 120). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 10.0 in stage 39.0 (TID 120) in 6633 ms on 10.255.255.254 (executor driver) (10/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6588, boot = 593, init = 252, finish = 5743
25/10/11 20:54:43 INFO Executor: Finished task 8.0 in stage 39.0 (TID 118). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 8.0 in stage 39.0 (TID 118) in 6654 ms on 10.255.255.254 (executor driver) (11/12)
25/10/11 20:54:43 INFO PythonRunner: Times: total = 6580, boot = 580, init = 284, finish = 5716
25/10/11 20:54:43 INFO Executor: Finished task 2.0 in stage 39.0 (TID 112). 2010 bytes result sent to driver
25/10/11 20:54:43 INFO TaskSetManager: Finished task 2.0 in stage 39.0 (TID 112) in 6688 ms on 10.255.255.254 (executor driver) (12/12)
25/10/11 20:54:43 INFO TaskSchedulerImpl: Removed TaskSet 39.0, whose tasks have all completed, from pool 
25/10/11 20:54:43 INFO DAGScheduler: ShuffleMapStage 39 (coalesce at NativeMethodAccessorImpl.java:0) finished in 6.699 s
25/10/11 20:54:43 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:43 INFO DAGScheduler: running: Set()
25/10/11 20:54:43 INFO DAGScheduler: waiting: Set(ResultStage 40)
25/10/11 20:54:43 INFO DAGScheduler: failed: Set()
25/10/11 20:54:43 INFO DAGScheduler: Submitting ResultStage 40 (PythonRDD[98] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158), which has no missing parents
25/10/11 20:54:43 INFO MemoryStore: Block broadcast_33 stored as values in memory (estimated size 12.1 KiB, free 433.4 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block broadcast_33_piece0 stored as bytes in memory (estimated size 6.7 KiB, free 433.4 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added broadcast_33_piece0 in memory on 10.255.255.254:38093 (size: 6.7 KiB, free: 434.2 MiB)
25/10/11 20:54:43 INFO SparkContext: Created broadcast 33 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:43 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 40 (PythonRDD[98] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:43 INFO TaskSchedulerImpl: Adding task set 40.0 with 8 tasks resource profile 0
25/10/11 20:54:43 INFO TaskSetManager: Starting task 0.0 in stage 40.0 (TID 122) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 1.0 in stage 40.0 (TID 123) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 2.0 in stage 40.0 (TID 124) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 3.0 in stage 40.0 (TID 125) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 4.0 in stage 40.0 (TID 126) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 5.0 in stage 40.0 (TID 127) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 6.0 in stage 40.0 (TID 128) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO TaskSetManager: Starting task 7.0 in stage 40.0 (TID 129) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 9093 bytes) 
25/10/11 20:54:43 INFO Executor: Running task 6.0 in stage 40.0 (TID 128)
25/10/11 20:54:43 INFO Executor: Running task 0.0 in stage 40.0 (TID 122)
25/10/11 20:54:43 INFO Executor: Running task 1.0 in stage 40.0 (TID 123)
25/10/11 20:54:43 INFO Executor: Running task 7.0 in stage 40.0 (TID 129)
25/10/11 20:54:43 INFO Executor: Running task 3.0 in stage 40.0 (TID 125)
25/10/11 20:54:43 INFO Executor: Running task 5.0 in stage 40.0 (TID 127)
25/10/11 20:54:43 INFO Executor: Running task 2.0 in stage 40.0 (TID 124)
25/10/11 20:54:43 INFO Executor: Running task 4.0 in stage 40.0 (TID 126)
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Getting 12 (9.2 MiB) non-empty blocks including 12 (9.2 MiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:43 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:43 INFO BlockManagerInfo: Removed broadcast_32_piece0 on 10.255.255.254:38093 in memory (size: 14.8 KiB, free: 434.3 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_0 stored as values in memory (estimated size 8.8 MiB, free 424.7 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_0 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 425.5 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_4 stored as values in memory (estimated size 8.8 MiB, free 415.9 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_4 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 416.7 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_2 stored as values in memory (estimated size 8.8 MiB, free 407.1 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_2 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 407.9 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_1 stored as values in memory (estimated size 8.8 MiB, free 398.3 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_1 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 399.1 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_5 stored as values in memory (estimated size 8.8 MiB, free 389.5 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_5 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 390.3 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_3 stored as values in memory (estimated size 8.8 MiB, free 380.7 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_3 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 381.5 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_7 stored as values in memory (estimated size 8.8 MiB, free 371.9 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_7 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 372.7 MiB)
25/10/11 20:54:43 INFO MemoryStore: Block rdd_95_6 stored as values in memory (estimated size 8.8 MiB, free 363.1 MiB)
25/10/11 20:54:43 INFO BlockManagerInfo: Added rdd_95_6 in memory on 10.255.255.254:38093 (size: 8.8 MiB, free: 363.9 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 567, boot = -2127, init = 2192, finish = 502
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_0 stored as values in memory (estimated size 166.7 KiB, free 363.0 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_0 in memory on 10.255.255.254:38093 (size: 166.7 KiB, free: 363.8 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 64, boot = -883, init = 943, finish = 4
25/10/11 20:54:44 INFO Executor: Finished task 0.0 in stage 40.0 (TID 122). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 0.0 in stage 40.0 (TID 122) in 870 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 585, boot = -683, init = 766, finish = 502
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_2 stored as values in memory (estimated size 154.8 KiB, free 362.8 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_2 in memory on 10.255.255.254:38093 (size: 154.8 KiB, free: 363.6 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 619, boot = -864, init = 948, finish = 535
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_4 stored as values in memory (estimated size 159.8 KiB, free 362.7 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_4 in memory on 10.255.255.254:38093 (size: 159.8 KiB, free: 363.4 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 652, boot = -612, init = 712, finish = 552
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_5 stored as values in memory (estimated size 154.8 KiB, free 362.5 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_5 in memory on 10.255.255.254:38093 (size: 154.8 KiB, free: 363.3 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 629, boot = -524, init = 620, finish = 533
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_7 stored as values in memory (estimated size 163.9 KiB, free 362.3 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 623, boot = -624, init = 714, finish = 533
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_7 in memory on 10.255.255.254:38093 (size: 163.9 KiB, free: 363.1 MiB)
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_3 stored as values in memory (estimated size 159.1 KiB, free 362.2 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_3 in memory on 10.255.255.254:38093 (size: 159.1 KiB, free: 363.0 MiB)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 46, boot = -941, init = 977, finish = 10
25/10/11 20:54:44 INFO PythonRunner: Times: total = 681, boot = -702, init = 786, finish = 597
25/10/11 20:54:44 INFO PythonRunner: Times: total = 619, boot = -413, init = 496, finish = 536
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_1 stored as values in memory (estimated size 155.0 KiB, free 362.0 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_1 in memory on 10.255.255.254:38093 (size: 155.0 KiB, free: 362.8 MiB)
25/10/11 20:54:44 INFO MemoryStore: Block rdd_96_6 stored as values in memory (estimated size 163.9 KiB, free 361.9 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added rdd_96_6 in memory on 10.255.255.254:38093 (size: 163.9 KiB, free: 362.7 MiB)
25/10/11 20:54:44 INFO Executor: Finished task 2.0 in stage 40.0 (TID 124). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 2.0 in stage 40.0 (TID 124) in 946 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 66, boot = -942, init = 998, finish = 10
25/10/11 20:54:44 INFO Executor: Finished task 4.0 in stage 40.0 (TID 126). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 4.0 in stage 40.0 (TID 126) in 970 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 47, boot = -68, init = 110, finish = 5
25/10/11 20:54:44 INFO PythonRunner: Times: total = 83, boot = -963, init = 1036, finish = 10
25/10/11 20:54:44 INFO PythonRunner: Times: total = 73, boot = -132, init = 194, finish = 11
25/10/11 20:54:44 INFO Executor: Finished task 6.0 in stage 40.0 (TID 128). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 6.0 in stage 40.0 (TID 128) in 997 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:44 INFO Executor: Finished task 5.0 in stage 40.0 (TID 127). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO Executor: Finished task 7.0 in stage 40.0 (TID 129). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 5.0 in stage 40.0 (TID 127) in 1000 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:44 INFO TaskSetManager: Finished task 7.0 in stage 40.0 (TID 129) in 1001 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 84, boot = -44, init = 122, finish = 6
25/10/11 20:54:44 INFO Executor: Finished task 3.0 in stage 40.0 (TID 125). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 3.0 in stage 40.0 (TID 125) in 1013 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:44 INFO PythonRunner: Times: total = 75, boot = -87, init = 156, finish = 6
25/10/11 20:54:44 INFO Executor: Finished task 1.0 in stage 40.0 (TID 123). 2098 bytes result sent to driver
25/10/11 20:54:44 INFO TaskSetManager: Finished task 1.0 in stage 40.0 (TID 123) in 1019 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:44 INFO TaskSchedulerImpl: Removed TaskSet 40.0, whose tasks have all completed, from pool 
25/10/11 20:54:44 INFO DAGScheduler: ResultStage 40 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) finished in 1.029 s
25/10/11 20:54:44 INFO DAGScheduler: Job 22 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 40: Stage finished
25/10/11 20:54:44 INFO DAGScheduler: Job 22 finished: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158, took 7.739909 s
25/10/11 20:54:44 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158
25/10/11 20:54:44 INFO DAGScheduler: Got job 23 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) with 8 output partitions
25/10/11 20:54:44 INFO DAGScheduler: Final stage: ResultStage 42 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158)
25/10/11 20:54:44 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 41)
25/10/11 20:54:44 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:44 INFO DAGScheduler: Submitting ResultStage 42 (PythonRDD[99] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158), which has no missing parents
25/10/11 20:54:44 INFO MemoryStore: Block broadcast_34 stored as values in memory (estimated size 12.1 KiB, free 361.9 MiB)
25/10/11 20:54:44 INFO MemoryStore: Block broadcast_34_piece0 stored as bytes in memory (estimated size 6.7 KiB, free 361.9 MiB)
25/10/11 20:54:44 INFO BlockManagerInfo: Added broadcast_34_piece0 in memory on 10.255.255.254:38093 (size: 6.7 KiB, free: 362.7 MiB)
25/10/11 20:54:44 INFO SparkContext: Created broadcast 34 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:44 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 42 (PythonRDD[99] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:44 INFO TaskSchedulerImpl: Adding task set 42.0 with 8 tasks resource profile 0
25/10/11 20:54:44 INFO TaskSetManager: Starting task 0.0 in stage 42.0 (TID 130) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 1.0 in stage 42.0 (TID 131) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 2.0 in stage 42.0 (TID 132) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 3.0 in stage 42.0 (TID 133) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 4.0 in stage 42.0 (TID 134) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 5.0 in stage 42.0 (TID 135) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 6.0 in stage 42.0 (TID 136) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO TaskSetManager: Starting task 7.0 in stage 42.0 (TID 137) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 9093 bytes) 
25/10/11 20:54:44 INFO Executor: Running task 7.0 in stage 42.0 (TID 137)
25/10/11 20:54:44 INFO Executor: Running task 5.0 in stage 42.0 (TID 135)
25/10/11 20:54:44 INFO Executor: Running task 3.0 in stage 42.0 (TID 133)
25/10/11 20:54:44 INFO Executor: Running task 4.0 in stage 42.0 (TID 134)
25/10/11 20:54:44 INFO Executor: Running task 6.0 in stage 42.0 (TID 136)
25/10/11 20:54:44 INFO Executor: Running task 1.0 in stage 42.0 (TID 131)
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_5 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_6 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_4 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_1 locally
25/10/11 20:54:44 INFO Executor: Running task 0.0 in stage 42.0 (TID 130)
25/10/11 20:54:44 INFO Executor: Running task 2.0 in stage 42.0 (TID 132)
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_7 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_0 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_2 locally
25/10/11 20:54:44 INFO BlockManager: Found block rdd_95_3 locally
25/10/11 20:54:44 INFO BlockManagerInfo: Removed broadcast_33_piece0 on 10.255.255.254:38093 in memory (size: 6.7 KiB, free: 362.7 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1088, boot = -93, init = 175, finish = 1006
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_2 stored as values in memory (estimated size 8.4 MiB, free 353.5 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_2 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 354.3 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1113, boot = -111, init = 206, finish = 1018
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_7 stored as values in memory (estimated size 8.4 MiB, free 345.1 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_7 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 345.9 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1138, boot = -137, init = 233, finish = 1042
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_6 stored as values in memory (estimated size 8.4 MiB, free 336.8 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_6 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 337.6 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1156, boot = -123, init = 192, finish = 1087
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_0 stored as values in memory (estimated size 8.4 MiB, free 328.4 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_0 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 329.2 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1184, boot = -106, init = 261, finish = 1029
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_4 stored as values in memory (estimated size 8.4 MiB, free 320.1 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_4 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 320.9 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1189, boot = -67, init = 209, finish = 1047
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_3 stored as values in memory (estimated size 8.4 MiB, free 311.7 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_3 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 312.5 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1218, boot = -157, init = 289, finish = 1086
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_1 stored as values in memory (estimated size 8.4 MiB, free 303.3 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_1 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 304.1 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 1397, boot = -113, init = 237, finish = 1273
25/10/11 20:54:45 INFO MemoryStore: Block rdd_97_5 stored as values in memory (estimated size 8.4 MiB, free 295.0 MiB)
25/10/11 20:54:45 INFO BlockManagerInfo: Added rdd_97_5 in memory on 10.255.255.254:38093 (size: 8.4 MiB, free: 295.8 MiB)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 394, boot = -1208, init = 1264, finish = 338
25/10/11 20:54:45 INFO Executor: Finished task 7.0 in stage 42.0 (TID 137). 1455 bytes result sent to driver
25/10/11 20:54:45 INFO TaskSetManager: Finished task 7.0 in stage 42.0 (TID 137) in 1570 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 389, boot = -1212, init = 1259, finish = 342
25/10/11 20:54:45 INFO Executor: Finished task 6.0 in stage 42.0 (TID 136). 1455 bytes result sent to driver
25/10/11 20:54:45 INFO TaskSetManager: Finished task 6.0 in stage 42.0 (TID 136) in 1580 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 366, boot = -119, init = 157, finish = 328
25/10/11 20:54:45 INFO Executor: Finished task 3.0 in stage 42.0 (TID 133). 1455 bytes result sent to driver
25/10/11 20:54:45 INFO TaskSetManager: Finished task 3.0 in stage 42.0 (TID 133) in 1626 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:45 INFO PythonRunner: Times: total = 497, boot = -1189, init = 1251, finish = 435
25/10/11 20:54:45 INFO Executor: Finished task 2.0 in stage 42.0 (TID 132). 1455 bytes result sent to driver
25/10/11 20:54:45 INFO TaskSetManager: Finished task 2.0 in stage 42.0 (TID 132) in 1656 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 493, boot = -1241, init = 1312, finish = 422
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 42.0 (TID 130). 1455 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 42.0 (TID 130) in 1714 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 459, boot = -112, init = 191, finish = 380
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 42.0 (TID 131). 1455 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 42.0 (TID 131) in 1736 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 507, boot = -105, init = 189, finish = 423
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 42.0 (TID 134). 1455 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 42.0 (TID 134) in 1748 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 365, boot = -259, init = 320, finish = 304
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 42.0 (TID 135). 1455 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 42.0 (TID 135) in 1818 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 42.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ResultStage 42 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158) finished in 1.825 s
25/10/11 20:54:46 INFO DAGScheduler: Job 23 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:46 INFO TaskSchedulerImpl: Killing all running tasks in stage 42: Stage finished
25/10/11 20:54:46 INFO DAGScheduler: Job 23 finished: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:158, took 2.847260 s
  > 1-3. Filter: Separated 16,848 purchases, 968,512 views
25/10/11 20:54:46 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164
25/10/11 20:54:46 INFO DAGScheduler: Registering RDD 101 (reduceByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:163) as input to shuffle 12
25/10/11 20:54:46 INFO DAGScheduler: Got job 24 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164) with 8 output partitions
25/10/11 20:54:46 INFO DAGScheduler: Final stage: ResultStage 45 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164)
25/10/11 20:54:46 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 44)
25/10/11 20:54:46 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 44)
25/10/11 20:54:46 INFO DAGScheduler: Submitting ShuffleMapStage 44 (PairwiseRDD[101] at reduceByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:163), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_35 stored as values in memory (estimated size 14.5 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_35_piece0 stored as bytes in memory (estimated size 8.3 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_35_piece0 in memory on 10.255.255.254:38093 (size: 8.3 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 35 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 8 missing tasks from ShuffleMapStage 44 (PairwiseRDD[101] at reduceByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:163) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 44.0 with 8 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 44.0 (TID 138) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 1.0 in stage 44.0 (TID 139) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 2.0 in stage 44.0 (TID 140) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 3.0 in stage 44.0 (TID 141) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 4.0 in stage 44.0 (TID 142) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 5.0 in stage 44.0 (TID 143) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 6.0 in stage 44.0 (TID 144) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 7.0 in stage 44.0 (TID 145) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 3.0 in stage 44.0 (TID 141)
25/10/11 20:54:46 INFO Executor: Running task 6.0 in stage 44.0 (TID 144)
25/10/11 20:54:46 INFO Executor: Running task 4.0 in stage 44.0 (TID 142)
25/10/11 20:54:46 INFO Executor: Running task 2.0 in stage 44.0 (TID 140)
25/10/11 20:54:46 INFO Executor: Running task 5.0 in stage 44.0 (TID 143)
25/10/11 20:54:46 INFO Executor: Running task 1.0 in stage 44.0 (TID 139)
25/10/11 20:54:46 INFO Executor: Running task 7.0 in stage 44.0 (TID 145)
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 44.0 (TID 138)
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_7 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_3 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_4 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_5 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_6 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_2 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_0 locally
25/10/11 20:54:46 INFO BlockManager: Found block rdd_96_1 locally
25/10/11 20:54:46 INFO PythonRunner: Times: total = 78, boot = -634, init = 701, finish = 11
25/10/11 20:54:46 INFO PythonRunner: Times: total = 45, boot = -252, init = 289, finish = 8
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 44.0 (TID 143). 1675 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 44.0 (TID 143) in 127 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:46 INFO Executor: Finished task 2.0 in stage 44.0 (TID 140). 1675 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 2.0 in stage 44.0 (TID 140) in 135 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 88, boot = -294, init = 365, finish = 17
25/10/11 20:54:46 INFO PythonRunner: Times: total = 83, boot = -454, init = 529, finish = 8
25/10/11 20:54:46 INFO PythonRunner: Times: total = 91, boot = -216, init = 291, finish = 16
25/10/11 20:54:46 INFO PythonRunner: Times: total = 96, boot = -658, init = 736, finish = 18
25/10/11 20:54:46 INFO PythonRunner: Times: total = 51, boot = -672, init = 711, finish = 12
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 44.0 (TID 139). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 3.0 in stage 44.0 (TID 141). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 3.0 in stage 44.0 (TID 141) in 146 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 44.0 (TID 139) in 146 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 65, boot = -304, init = 361, finish = 8
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 44.0 (TID 142). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 7.0 in stage 44.0 (TID 145). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 44.0 (TID 142) in 153 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO Executor: Finished task 6.0 in stage 44.0 (TID 144). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 7.0 in stage 44.0 (TID 145) in 154 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 44.0 (TID 138). 1632 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 6.0 in stage 44.0 (TID 144) in 154 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 44.0 (TID 138) in 155 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 44.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ShuffleMapStage 44 (reduceByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:163) finished in 0.160 s
25/10/11 20:54:46 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:46 INFO DAGScheduler: running: Set()
25/10/11 20:54:46 INFO DAGScheduler: waiting: Set(ResultStage 45)
25/10/11 20:54:46 INFO DAGScheduler: failed: Set()
25/10/11 20:54:46 INFO DAGScheduler: Submitting ResultStage 45 (PythonRDD[104] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_36 stored as values in memory (estimated size 11.7 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_36_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_36_piece0 in memory on 10.255.255.254:38093 (size: 6.8 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 36 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 45 (PythonRDD[104] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 45.0 with 8 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 45.0 (TID 146) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 1.0 in stage 45.0 (TID 147) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO BlockManagerInfo: Removed broadcast_34_piece0 on 10.255.255.254:38093 in memory (size: 6.7 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO TaskSetManager: Starting task 2.0 in stage 45.0 (TID 148) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 3.0 in stage 45.0 (TID 149) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 4.0 in stage 45.0 (TID 150) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 5.0 in stage 45.0 (TID 151) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 6.0 in stage 45.0 (TID 152) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 7.0 in stage 45.0 (TID 153) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 1.0 in stage 45.0 (TID 147)
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 45.0 (TID 146)
25/10/11 20:54:46 INFO Executor: Running task 7.0 in stage 45.0 (TID 153)
25/10/11 20:54:46 INFO Executor: Running task 5.0 in stage 45.0 (TID 151)
25/10/11 20:54:46 INFO Executor: Running task 2.0 in stage 45.0 (TID 148)
25/10/11 20:54:46 INFO Executor: Running task 6.0 in stage 45.0 (TID 152)
25/10/11 20:54:46 INFO Executor: Running task 3.0 in stage 45.0 (TID 149)
25/10/11 20:54:46 INFO Executor: Running task 4.0 in stage 45.0 (TID 150)
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.4 KiB) non-empty blocks including 8 (5.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.2 KiB) non-empty blocks including 8 (5.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.1 KiB) non-empty blocks including 8 (5.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.4 KiB) non-empty blocks including 8 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.3 KiB) non-empty blocks including 8 (4.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.0 KiB) non-empty blocks including 8 (5.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.0 KiB) non-empty blocks including 8 (6.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.6 KiB) non-empty blocks including 8 (6.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO PythonRunner: Times: total = 56, boot = -246, init = 302, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 7.0 in stage 45.0 (TID 153). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 7.0 in stage 45.0 (TID 153) in 77 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 73, boot = -349, init = 421, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 45.0 (TID 150). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO PythonRunner: Times: total = 49, boot = -99, init = 148, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 6.0 in stage 45.0 (TID 152). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO PythonRunner: Times: total = 69, boot = -139, init = 208, finish = 0
25/10/11 20:54:46 INFO PythonRunner: Times: total = 74, boot = -332, init = 405, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 2.0 in stage 45.0 (TID 148). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 45.0 (TID 146). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 45.0 (TID 150) in 93 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 78, boot = -317, init = 394, finish = 1
25/10/11 20:54:46 INFO TaskSetManager: Finished task 6.0 in stage 45.0 (TID 152) in 99 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 2.0 in stage 45.0 (TID 148) in 101 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO Executor: Finished task 3.0 in stage 45.0 (TID 149). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 45.0 (TID 146) in 103 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 3.0 in stage 45.0 (TID 149) in 103 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 86, boot = -102, init = 188, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 45.0 (TID 151). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 45.0 (TID 151) in 112 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 82, boot = -97, init = 178, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 45.0 (TID 147). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 45.0 (TID 147) in 128 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 45.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ResultStage 45 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164) finished in 0.145 s
25/10/11 20:54:46 INFO DAGScheduler: Job 24 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:46 INFO TaskSchedulerImpl: Killing all running tasks in stage 45: Stage finished
25/10/11 20:54:46 INFO DAGScheduler: Job 24 finished: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:164, took 0.309714 s
  > 4-5. Map + ReduceByKey: 645 brands aggregated
25/10/11 20:54:46 INFO SparkContext: Starting job: sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167
25/10/11 20:54:46 INFO DAGScheduler: Got job 25 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) with 8 output partitions
25/10/11 20:54:46 INFO DAGScheduler: Final stage: ResultStage 48 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167)
25/10/11 20:54:46 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 47)
25/10/11 20:54:46 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:46 INFO DAGScheduler: Submitting ResultStage 48 (PythonRDD[105] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_37 stored as values in memory (estimated size 12.4 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_37_piece0 stored as bytes in memory (estimated size 7.1 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_37_piece0 in memory on 10.255.255.254:38093 (size: 7.1 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 37 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 48 (PythonRDD[105] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 48.0 with 8 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 48.0 (TID 154) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 1.0 in stage 48.0 (TID 155) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 2.0 in stage 48.0 (TID 156) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 3.0 in stage 48.0 (TID 157) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 4.0 in stage 48.0 (TID 158) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 5.0 in stage 48.0 (TID 159) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 6.0 in stage 48.0 (TID 160) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 7.0 in stage 48.0 (TID 161) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 3.0 in stage 48.0 (TID 157)
25/10/11 20:54:46 INFO Executor: Running task 1.0 in stage 48.0 (TID 155)
25/10/11 20:54:46 INFO Executor: Running task 4.0 in stage 48.0 (TID 158)
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 48.0 (TID 154)
25/10/11 20:54:46 INFO Executor: Running task 2.0 in stage 48.0 (TID 156)
25/10/11 20:54:46 INFO Executor: Running task 5.0 in stage 48.0 (TID 159)
25/10/11 20:54:46 INFO Executor: Running task 7.0 in stage 48.0 (TID 161)
25/10/11 20:54:46 INFO Executor: Running task 6.0 in stage 48.0 (TID 160)
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.4 KiB) non-empty blocks including 8 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.3 KiB) non-empty blocks including 8 (4.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.0 KiB) non-empty blocks including 8 (5.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.4 KiB) non-empty blocks including 8 (5.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.1 KiB) non-empty blocks including 8 (5.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.0 KiB) non-empty blocks including 8 (6.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.2 KiB) non-empty blocks including 8 (5.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.6 KiB) non-empty blocks including 8 (6.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO PythonRunner: Times: total = 48, boot = -66, init = 114, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 3.0 in stage 48.0 (TID 157). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 3.0 in stage 48.0 (TID 157) in 60 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 57, boot = -251, init = 307, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 2.0 in stage 48.0 (TID 156). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 2.0 in stage 48.0 (TID 156) in 70 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 68, boot = -50, init = 118, finish = 0
25/10/11 20:54:46 INFO PythonRunner: Times: total = 71, boot = -39, init = 109, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 48.0 (TID 158). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 48.0 (TID 155). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO PythonRunner: Times: total = 72, boot = -214, init = 286, finish = 0
25/10/11 20:54:46 INFO PythonRunner: Times: total = 73, boot = -40, init = 113, finish = 0
25/10/11 20:54:46 INFO PythonRunner: Times: total = 76, boot = -236, init = 311, finish = 1
25/10/11 20:54:46 INFO PythonRunner: Times: total = 77, boot = -206, init = 283, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 48.0 (TID 159). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 6.0 in stage 48.0 (TID 160). 2054 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 7.0 in stage 48.0 (TID 161). 2011 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 48.0 (TID 154). 2097 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 48.0 (TID 158) in 86 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 48.0 (TID 159) in 86 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 48.0 (TID 155) in 87 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 6.0 in stage 48.0 (TID 160) in 86 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 48.0 (TID 154) in 90 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 7.0 in stage 48.0 (TID 161) in 90 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 48.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ResultStage 48 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) finished in 0.097 s
25/10/11 20:54:46 INFO DAGScheduler: Job 25 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:46 INFO TaskSchedulerImpl: Killing all running tasks in stage 48: Stage finished
25/10/11 20:54:46 INFO DAGScheduler: Job 25 finished: sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167, took 0.099167 s
25/10/11 20:54:46 INFO SparkContext: Starting job: sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167
25/10/11 20:54:46 INFO DAGScheduler: Got job 26 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) with 8 output partitions
25/10/11 20:54:46 INFO DAGScheduler: Final stage: ResultStage 51 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167)
25/10/11 20:54:46 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 50)
25/10/11 20:54:46 INFO DAGScheduler: Missing parents: List()
25/10/11 20:54:46 INFO DAGScheduler: Submitting ResultStage 51 (PythonRDD[106] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_38 stored as values in memory (estimated size 11.6 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_38_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_38_piece0 in memory on 10.255.255.254:38093 (size: 6.8 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 38 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 51 (PythonRDD[106] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 51.0 with 8 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 51.0 (TID 162) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 1.0 in stage 51.0 (TID 163) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 2.0 in stage 51.0 (TID 164) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 3.0 in stage 51.0 (TID 165) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 4.0 in stage 51.0 (TID 166) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 5.0 in stage 51.0 (TID 167) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 6.0 in stage 51.0 (TID 168) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 7.0 in stage 51.0 (TID 169) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 2.0 in stage 51.0 (TID 164)
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 51.0 (TID 162)
25/10/11 20:54:46 INFO Executor: Running task 3.0 in stage 51.0 (TID 165)
25/10/11 20:54:46 INFO Executor: Running task 1.0 in stage 51.0 (TID 163)
25/10/11 20:54:46 INFO Executor: Running task 4.0 in stage 51.0 (TID 166)
25/10/11 20:54:46 INFO Executor: Running task 5.0 in stage 51.0 (TID 167)
25/10/11 20:54:46 INFO Executor: Running task 7.0 in stage 51.0 (TID 169)
25/10/11 20:54:46 INFO Executor: Running task 6.0 in stage 51.0 (TID 168)
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.6 KiB) non-empty blocks including 8 (6.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.0 KiB) non-empty blocks including 8 (5.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.1 KiB) non-empty blocks including 8 (5.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.3 KiB) non-empty blocks including 8 (4.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.2 KiB) non-empty blocks including 8 (5.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.4 KiB) non-empty blocks including 8 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.4 KiB) non-empty blocks including 8 (5.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.0 KiB) non-empty blocks including 8 (6.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO PythonRunner: Times: total = 59, boot = -159, init = 217, finish = 1
25/10/11 20:54:46 INFO PythonRunner: Times: total = 59, boot = -36, init = 94, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 3.0 in stage 51.0 (TID 165). 2201 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 51.0 (TID 167). 2241 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 3.0 in stage 51.0 (TID 165) in 72 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 65, boot = -50, init = 115, finish = 0
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 51.0 (TID 167) in 76 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 51.0 (TID 162). 2241 bytes result sent to driver
25/10/11 20:54:46 INFO PythonRunner: Times: total = 66, boot = -25, init = 90, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 51.0 (TID 163). 2241 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 51.0 (TID 162) in 81 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 51.0 (TID 163) in 82 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 73, boot = -148, init = 220, finish = 1
25/10/11 20:54:46 INFO PythonRunner: Times: total = 74, boot = -162, init = 235, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 6.0 in stage 51.0 (TID 168). 2384 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 2.0 in stage 51.0 (TID 164). 2321 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 2.0 in stage 51.0 (TID 164) in 86 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 6.0 in stage 51.0 (TID 168) in 85 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 78, boot = -57, init = 134, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 7.0 in stage 51.0 (TID 169). 2302 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 7.0 in stage 51.0 (TID 169) in 90 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 90, boot = -144, init = 233, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 51.0 (TID 166). 2330 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 51.0 (TID 166) in 102 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 51.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ResultStage 51 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) finished in 0.107 s
25/10/11 20:54:46 INFO DAGScheduler: Job 26 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:46 INFO TaskSchedulerImpl: Killing all running tasks in stage 51: Stage finished
25/10/11 20:54:46 INFO DAGScheduler: Job 26 finished: sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167, took 0.113075 s
25/10/11 20:54:46 INFO SparkContext: Starting job: runJob at PythonRDD.scala:181
25/10/11 20:54:46 INFO DAGScheduler: Registering RDD 108 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) as input to shuffle 13
25/10/11 20:54:46 INFO DAGScheduler: Got job 27 (runJob at PythonRDD.scala:181) with 1 output partitions
25/10/11 20:54:46 INFO DAGScheduler: Final stage: ResultStage 55 (runJob at PythonRDD.scala:181)
25/10/11 20:54:46 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 54)
25/10/11 20:54:46 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 54)
25/10/11 20:54:46 INFO DAGScheduler: Submitting ShuffleMapStage 54 (PairwiseRDD[108] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_39 stored as values in memory (estimated size 13.3 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_39_piece0 stored as bytes in memory (estimated size 8.1 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_39_piece0 in memory on 10.255.255.254:38093 (size: 8.1 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 39 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 8 missing tasks from ShuffleMapStage 54 (PairwiseRDD[108] at sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 54.0 with 8 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 54.0 (TID 170) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 1.0 in stage 54.0 (TID 171) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 2.0 in stage 54.0 (TID 172) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 3.0 in stage 54.0 (TID 173) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 4.0 in stage 54.0 (TID 174) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 5.0 in stage 54.0 (TID 175) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 6.0 in stage 54.0 (TID 176) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO TaskSetManager: Starting task 7.0 in stage 54.0 (TID 177) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8806 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 4.0 in stage 54.0 (TID 174)
25/10/11 20:54:46 INFO Executor: Running task 2.0 in stage 54.0 (TID 172)
25/10/11 20:54:46 INFO Executor: Running task 6.0 in stage 54.0 (TID 176)
25/10/11 20:54:46 INFO Executor: Running task 3.0 in stage 54.0 (TID 173)
25/10/11 20:54:46 INFO Executor: Running task 1.0 in stage 54.0 (TID 171)
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 54.0 (TID 170)
25/10/11 20:54:46 INFO Executor: Running task 5.0 in stage 54.0 (TID 175)
25/10/11 20:54:46 INFO Executor: Running task 7.0 in stage 54.0 (TID 177)
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.6 KiB) non-empty blocks including 8 (6.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.2 KiB) non-empty blocks including 8 (5.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.4 KiB) non-empty blocks including 8 (4.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.1 KiB) non-empty blocks including 8 (5.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.4 KiB) non-empty blocks including 8 (5.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (5.0 KiB) non-empty blocks including 8 (5.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (4.3 KiB) non-empty blocks including 8 (4.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (6.0 KiB) non-empty blocks including 8 (6.0 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/10/11 20:54:46 INFO PythonRunner: Times: total = 47, boot = -174, init = 221, finish = 0
25/10/11 20:54:46 INFO Executor: Finished task 7.0 in stage 54.0 (TID 177). 2277 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 7.0 in stage 54.0 (TID 177) in 93 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 73, boot = -176, init = 248, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 6.0 in stage 54.0 (TID 176). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO PythonRunner: Times: total = 76, boot = -180, init = 255, finish = 1
25/10/11 20:54:46 INFO TaskSetManager: Finished task 6.0 in stage 54.0 (TID 176) in 110 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:46 INFO Executor: Finished task 3.0 in stage 54.0 (TID 173). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 3.0 in stage 54.0 (TID 173) in 117 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 73, boot = -171, init = 243, finish = 1
25/10/11 20:54:46 INFO PythonRunner: Times: total = 69, boot = -68, init = 136, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 4.0 in stage 54.0 (TID 174). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 4.0 in stage 54.0 (TID 174) in 129 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:46 INFO Executor: Finished task 5.0 in stage 54.0 (TID 175). 2191 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 5.0 in stage 54.0 (TID 175) in 132 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:46 INFO PythonRunner: Times: total = 101, boot = -69, init = 167, finish = 3
25/10/11 20:54:46 INFO PythonRunner: Times: total = 97, boot = -70, init = 163, finish = 4
25/10/11 20:54:46 INFO PythonRunner: Times: total = 78, boot = -85, init = 162, finish = 1
25/10/11 20:54:46 INFO Executor: Finished task 2.0 in stage 54.0 (TID 172). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO Executor: Finished task 0.0 in stage 54.0 (TID 170). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 2.0 in stage 54.0 (TID 172) in 144 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:46 INFO TaskSetManager: Finished task 0.0 in stage 54.0 (TID 170) in 146 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:46 INFO Executor: Finished task 1.0 in stage 54.0 (TID 171). 2234 bytes result sent to driver
25/10/11 20:54:46 INFO TaskSetManager: Finished task 1.0 in stage 54.0 (TID 171) in 147 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:46 INFO TaskSchedulerImpl: Removed TaskSet 54.0, whose tasks have all completed, from pool 
25/10/11 20:54:46 INFO DAGScheduler: ShuffleMapStage 54 (sortBy at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:167) finished in 0.155 s
25/10/11 20:54:46 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:46 INFO DAGScheduler: running: Set()
25/10/11 20:54:46 INFO DAGScheduler: waiting: Set(ResultStage 55)
25/10/11 20:54:46 INFO DAGScheduler: failed: Set()
25/10/11 20:54:46 INFO DAGScheduler: Submitting ResultStage 55 (PythonRDD[111] at RDD at PythonRDD.scala:53), which has no missing parents
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_40 stored as values in memory (estimated size 10.4 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO MemoryStore: Block broadcast_40_piece0 stored as bytes in memory (estimated size 6.2 KiB, free 294.9 MiB)
25/10/11 20:54:46 INFO BlockManagerInfo: Added broadcast_40_piece0 in memory on 10.255.255.254:38093 (size: 6.2 KiB, free: 295.7 MiB)
25/10/11 20:54:46 INFO SparkContext: Created broadcast 40 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:46 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 55 (PythonRDD[111] at RDD at PythonRDD.scala:53) (first 15 tasks are for partitions Vector(0))
25/10/11 20:54:46 INFO TaskSchedulerImpl: Adding task set 55.0 with 1 tasks resource profile 0
25/10/11 20:54:46 INFO TaskSetManager: Starting task 0.0 in stage 55.0 (TID 178) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:46 INFO Executor: Running task 0.0 in stage 55.0 (TID 178)
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Getting 8 (2.2 KiB) non-empty blocks including 8 (2.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:46 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO PythonRunner: Times: total = 49, boot = -208, init = 257, finish = 0
25/10/11 20:54:47 INFO Executor: Finished task 0.0 in stage 55.0 (TID 178). 2138 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 0.0 in stage 55.0 (TID 178) in 62 ms on 10.255.255.254 (executor driver) (1/1)
25/10/11 20:54:47 INFO TaskSchedulerImpl: Removed TaskSet 55.0, whose tasks have all completed, from pool 
25/10/11 20:54:47 INFO DAGScheduler: ResultStage 55 (runJob at PythonRDD.scala:181) finished in 0.068 s
25/10/11 20:54:47 INFO DAGScheduler: Job 27 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:47 INFO TaskSchedulerImpl: Killing all running tasks in stage 55: Stage finished
25/10/11 20:54:47 INFO DAGScheduler: Job 27 finished: runJob at PythonRDD.scala:181, took 0.230506 s
  > 6. SortBy: Top brand: apple ($2,717,407)
25/10/11 20:54:47 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174
25/10/11 20:54:47 INFO DAGScheduler: Registering RDD 113 (distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:172) as input to shuffle 14
25/10/11 20:54:47 INFO DAGScheduler: Got job 28 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) with 8 output partitions
25/10/11 20:54:47 INFO DAGScheduler: Final stage: ResultStage 58 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174)
25/10/11 20:54:47 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 57)
25/10/11 20:54:47 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 57)
25/10/11 20:54:47 INFO DAGScheduler: Submitting ShuffleMapStage 57 (PairwiseRDD[113] at distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:172), which has no missing parents
25/10/11 20:54:47 INFO MemoryStore: Block broadcast_41 stored as values in memory (estimated size 13.2 KiB, free 294.9 MiB)
25/10/11 20:54:47 INFO MemoryStore: Block broadcast_41_piece0 stored as bytes in memory (estimated size 8.0 KiB, free 294.8 MiB)
25/10/11 20:54:47 INFO BlockManagerInfo: Added broadcast_41_piece0 in memory on 10.255.255.254:38093 (size: 8.0 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO SparkContext: Created broadcast 41 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:47 INFO DAGScheduler: Submitting 8 missing tasks from ShuffleMapStage 57 (PairwiseRDD[113] at distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:172) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:47 INFO TaskSchedulerImpl: Adding task set 57.0 with 8 tasks resource profile 0
25/10/11 20:54:47 INFO TaskSetManager: Starting task 0.0 in stage 57.0 (TID 179) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 1.0 in stage 57.0 (TID 180) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 2.0 in stage 57.0 (TID 181) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 3.0 in stage 57.0 (TID 182) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 4.0 in stage 57.0 (TID 183) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 5.0 in stage 57.0 (TID 184) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 6.0 in stage 57.0 (TID 185) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 7.0 in stage 57.0 (TID 186) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:47 INFO Executor: Running task 1.0 in stage 57.0 (TID 180)
25/10/11 20:54:47 INFO Executor: Running task 6.0 in stage 57.0 (TID 185)
25/10/11 20:54:47 INFO Executor: Running task 5.0 in stage 57.0 (TID 184)
25/10/11 20:54:47 INFO Executor: Running task 2.0 in stage 57.0 (TID 181)
25/10/11 20:54:47 INFO Executor: Running task 7.0 in stage 57.0 (TID 186)
25/10/11 20:54:47 INFO Executor: Running task 0.0 in stage 57.0 (TID 179)
25/10/11 20:54:47 INFO Executor: Running task 3.0 in stage 57.0 (TID 182)
25/10/11 20:54:47 INFO Executor: Running task 4.0 in stage 57.0 (TID 183)
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_5 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_0 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_6 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_7 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_3 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_1 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_2 locally
25/10/11 20:54:47 INFO BlockManager: Found block rdd_95_4 locally
25/10/11 20:54:47 INFO PythonRunner: Times: total = 613, boot = -338, init = 379, finish = 572
25/10/11 20:54:47 INFO Executor: Finished task 5.0 in stage 57.0 (TID 184). 1589 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 5.0 in stage 57.0 (TID 184) in 628 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 648, boot = -165, init = 237, finish = 576
25/10/11 20:54:47 INFO Executor: Finished task 0.0 in stage 57.0 (TID 179). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 0.0 in stage 57.0 (TID 179) in 687 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_40_piece0 on 10.255.255.254:38093 in memory (size: 6.2 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 681, boot = -157, init = 247, finish = 591
25/10/11 20:54:47 INFO PythonRunner: Times: total = 664, boot = -335, init = 416, finish = 583
25/10/11 20:54:47 INFO Executor: Finished task 2.0 in stage 57.0 (TID 181). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_36_piece0 on 10.255.255.254:38093 in memory (size: 6.8 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO TaskSetManager: Finished task 2.0 in stage 57.0 (TID 181) in 704 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 678, boot = -201, init = 283, finish = 596
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_38_piece0 on 10.255.255.254:38093 in memory (size: 6.8 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO Executor: Finished task 7.0 in stage 57.0 (TID 186). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO Executor: Finished task 3.0 in stage 57.0 (TID 182). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 3.0 in stage 57.0 (TID 182) in 714 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:47 INFO TaskSetManager: Finished task 7.0 in stage 57.0 (TID 186) in 714 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 708, boot = -328, init = 376, finish = 660
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_37_piece0 on 10.255.255.254:38093 in memory (size: 7.1 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO Executor: Finished task 6.0 in stage 57.0 (TID 185). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 6.0 in stage 57.0 (TID 185) in 723 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_39_piece0 on 10.255.255.254:38093 in memory (size: 8.1 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO BlockManagerInfo: Removed broadcast_35_piece0 on 10.255.255.254:38093 in memory (size: 8.3 KiB, free: 295.8 MiB)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 734, boot = -157, init = 233, finish = 658
25/10/11 20:54:47 INFO PythonRunner: Times: total = 738, boot = -168, init = 233, finish = 673
25/10/11 20:54:47 INFO Executor: Finished task 4.0 in stage 57.0 (TID 183). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 4.0 in stage 57.0 (TID 183) in 751 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:47 INFO Executor: Finished task 1.0 in stage 57.0 (TID 180). 1632 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 1.0 in stage 57.0 (TID 180) in 753 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:47 INFO TaskSchedulerImpl: Removed TaskSet 57.0, whose tasks have all completed, from pool 
25/10/11 20:54:47 INFO DAGScheduler: ShuffleMapStage 57 (distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:172) finished in 0.761 s
25/10/11 20:54:47 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:47 INFO DAGScheduler: running: Set()
25/10/11 20:54:47 INFO DAGScheduler: waiting: Set(ResultStage 58)
25/10/11 20:54:47 INFO DAGScheduler: failed: Set()
25/10/11 20:54:47 INFO DAGScheduler: Submitting ResultStage 58 (PythonRDD[120] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174), which has no missing parents
25/10/11 20:54:47 INFO MemoryStore: Block broadcast_42 stored as values in memory (estimated size 12.2 KiB, free 294.9 MiB)
25/10/11 20:54:47 INFO MemoryStore: Block broadcast_42_piece0 stored as bytes in memory (estimated size 6.9 KiB, free 294.9 MiB)
25/10/11 20:54:47 INFO BlockManagerInfo: Added broadcast_42_piece0 in memory on 10.255.255.254:38093 (size: 6.9 KiB, free: 295.7 MiB)
25/10/11 20:54:47 INFO SparkContext: Created broadcast 42 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:47 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 58 (PythonRDD[120] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:47 INFO TaskSchedulerImpl: Adding task set 58.0 with 8 tasks resource profile 0
25/10/11 20:54:47 INFO TaskSetManager: Starting task 0.0 in stage 58.0 (TID 187) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 1.0 in stage 58.0 (TID 188) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 2.0 in stage 58.0 (TID 189) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 3.0 in stage 58.0 (TID 190) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 4.0 in stage 58.0 (TID 191) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 5.0 in stage 58.0 (TID 192) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 6.0 in stage 58.0 (TID 193) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO TaskSetManager: Starting task 7.0 in stage 58.0 (TID 194) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:47 INFO Executor: Running task 5.0 in stage 58.0 (TID 192)
25/10/11 20:54:47 INFO Executor: Running task 2.0 in stage 58.0 (TID 189)
25/10/11 20:54:47 INFO Executor: Running task 3.0 in stage 58.0 (TID 190)
25/10/11 20:54:47 INFO Executor: Running task 0.0 in stage 58.0 (TID 187)
25/10/11 20:54:47 INFO Executor: Running task 1.0 in stage 58.0 (TID 188)
25/10/11 20:54:47 INFO Executor: Running task 6.0 in stage 58.0 (TID 193)
25/10/11 20:54:47 INFO Executor: Running task 4.0 in stage 58.0 (TID 191)
25/10/11 20:54:47 INFO Executor: Running task 7.0 in stage 58.0 (TID 194)
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 2 ms
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Getting 8 (130.3 KiB) non-empty blocks including 8 (130.3 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:47 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:47 INFO PythonRunner: Times: total = 84, boot = -84, init = 145, finish = 23
25/10/11 20:54:47 INFO PythonRunner: Times: total = 86, boot = -821, init = 893, finish = 14
25/10/11 20:54:47 INFO Executor: Finished task 0.0 in stage 58.0 (TID 187). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO Executor: Finished task 6.0 in stage 58.0 (TID 193). 2012 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 0.0 in stage 58.0 (TID 187) in 97 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:47 INFO TaskSetManager: Finished task 6.0 in stage 58.0 (TID 193) in 96 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 90, boot = -898, init = 968, finish = 20
25/10/11 20:54:47 INFO Executor: Finished task 4.0 in stage 58.0 (TID 191). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 4.0 in stage 58.0 (TID 191) in 99 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 102, boot = -63, init = 139, finish = 26
25/10/11 20:54:47 INFO PythonRunner: Times: total = 103, boot = -94, init = 177, finish = 20
25/10/11 20:54:47 INFO Executor: Finished task 1.0 in stage 58.0 (TID 188). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO Executor: Finished task 2.0 in stage 58.0 (TID 189). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO PythonRunner: Times: total = 105, boot = -904, init = 980, finish = 29
25/10/11 20:54:47 INFO Executor: Finished task 3.0 in stage 58.0 (TID 190). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 2.0 in stage 58.0 (TID 189) in 115 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:47 INFO TaskSetManager: Finished task 1.0 in stage 58.0 (TID 188) in 116 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:47 INFO TaskSetManager: Finished task 3.0 in stage 58.0 (TID 190) in 120 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 119, boot = -122, init = 214, finish = 27
25/10/11 20:54:47 INFO Executor: Finished task 5.0 in stage 58.0 (TID 192). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 5.0 in stage 58.0 (TID 192) in 131 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:47 INFO PythonRunner: Times: total = 130, boot = -910, init = 1019, finish = 21
25/10/11 20:54:47 INFO Executor: Finished task 7.0 in stage 58.0 (TID 194). 2055 bytes result sent to driver
25/10/11 20:54:47 INFO TaskSetManager: Finished task 7.0 in stage 58.0 (TID 194) in 140 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:47 INFO TaskSchedulerImpl: Removed TaskSet 58.0, whose tasks have all completed, from pool 
25/10/11 20:54:47 INFO DAGScheduler: ResultStage 58 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) finished in 0.148 s
25/10/11 20:54:47 INFO DAGScheduler: Job 28 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:47 INFO TaskSchedulerImpl: Killing all running tasks in stage 58: Stage finished
25/10/11 20:54:47 INFO DAGScheduler: Job 28 finished: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174, took 0.915207 s
25/10/11 20:54:48 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174
25/10/11 20:54:48 INFO DAGScheduler: Registering RDD 117 (distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:173) as input to shuffle 15
25/10/11 20:54:48 INFO DAGScheduler: Got job 29 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) with 8 output partitions
25/10/11 20:54:48 INFO DAGScheduler: Final stage: ResultStage 61 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174)
25/10/11 20:54:48 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 60)
25/10/11 20:54:48 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 60)
25/10/11 20:54:48 INFO DAGScheduler: Submitting ShuffleMapStage 60 (PairwiseRDD[117] at distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:173), which has no missing parents
25/10/11 20:54:48 INFO MemoryStore: Block broadcast_43 stored as values in memory (estimated size 13.2 KiB, free 294.9 MiB)
25/10/11 20:54:48 INFO MemoryStore: Block broadcast_43_piece0 stored as bytes in memory (estimated size 8.0 KiB, free 294.9 MiB)
25/10/11 20:54:48 INFO BlockManagerInfo: Added broadcast_43_piece0 in memory on 10.255.255.254:38093 (size: 8.0 KiB, free: 295.7 MiB)
25/10/11 20:54:48 INFO SparkContext: Created broadcast 43 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:48 INFO DAGScheduler: Submitting 8 missing tasks from ShuffleMapStage 60 (PairwiseRDD[117] at distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:173) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:48 INFO TaskSchedulerImpl: Adding task set 60.0 with 8 tasks resource profile 0
25/10/11 20:54:48 INFO TaskSetManager: Starting task 0.0 in stage 60.0 (TID 195) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 1.0 in stage 60.0 (TID 196) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 2.0 in stage 60.0 (TID 197) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 3.0 in stage 60.0 (TID 198) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 4.0 in stage 60.0 (TID 199) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 5.0 in stage 60.0 (TID 200) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 6.0 in stage 60.0 (TID 201) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 7.0 in stage 60.0 (TID 202) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:48 INFO Executor: Running task 7.0 in stage 60.0 (TID 202)
25/10/11 20:54:48 INFO Executor: Running task 1.0 in stage 60.0 (TID 196)
25/10/11 20:54:48 INFO Executor: Running task 5.0 in stage 60.0 (TID 200)
25/10/11 20:54:48 INFO Executor: Running task 6.0 in stage 60.0 (TID 201)
25/10/11 20:54:48 INFO Executor: Running task 3.0 in stage 60.0 (TID 198)
25/10/11 20:54:48 INFO Executor: Running task 0.0 in stage 60.0 (TID 195)
25/10/11 20:54:48 INFO Executor: Running task 2.0 in stage 60.0 (TID 197)
25/10/11 20:54:48 INFO Executor: Running task 4.0 in stage 60.0 (TID 199)
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_0 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_2 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_1 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_6 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_3 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_7 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_4 locally
25/10/11 20:54:48 INFO BlockManager: Found block rdd_95_5 locally
25/10/11 20:54:48 INFO BlockManagerInfo: Removed broadcast_42_piece0 on 10.255.255.254:38093 in memory (size: 6.9 KiB, free: 295.7 MiB)
25/10/11 20:54:48 INFO PythonRunner: Times: total = 727, boot = -60, init = 167, finish = 620
25/10/11 20:54:48 INFO Executor: Finished task 5.0 in stage 60.0 (TID 200). 1675 bytes result sent to driver
25/10/11 20:54:48 INFO PythonRunner: Times: total = 761, boot = -59, init = 158, finish = 662
25/10/11 20:54:48 INFO TaskSetManager: Finished task 5.0 in stage 60.0 (TID 200) in 775 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:48 INFO Executor: Finished task 6.0 in stage 60.0 (TID 201). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 6.0 in stage 60.0 (TID 201) in 783 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:48 INFO BlockManagerInfo: Removed broadcast_41_piece0 on 10.255.255.254:38093 in memory (size: 8.0 KiB, free: 295.8 MiB)
25/10/11 20:54:48 INFO PythonRunner: Times: total = 879, boot = -169, init = 273, finish = 775
25/10/11 20:54:48 INFO PythonRunner: Times: total = 879, boot = -173, init = 281, finish = 771
25/10/11 20:54:48 INFO PythonRunner: Times: total = 883, boot = -199, init = 265, finish = 817
25/10/11 20:54:48 INFO Executor: Finished task 3.0 in stage 60.0 (TID 198). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO Executor: Finished task 1.0 in stage 60.0 (TID 196). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 1.0 in stage 60.0 (TID 196) in 894 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:48 INFO TaskSetManager: Finished task 3.0 in stage 60.0 (TID 198) in 894 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:48 INFO Executor: Finished task 2.0 in stage 60.0 (TID 197). 1675 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 2.0 in stage 60.0 (TID 197) in 897 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:48 INFO PythonRunner: Times: total = 897, boot = -55, init = 179, finish = 773
25/10/11 20:54:48 INFO PythonRunner: Times: total = 886, boot = -67, init = 162, finish = 791
25/10/11 20:54:48 INFO Executor: Finished task 7.0 in stage 60.0 (TID 202). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 7.0 in stage 60.0 (TID 202) in 909 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:48 INFO Executor: Finished task 4.0 in stage 60.0 (TID 199). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 4.0 in stage 60.0 (TID 199) in 913 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:48 INFO PythonRunner: Times: total = 912, boot = -231, init = 338, finish = 805
25/10/11 20:54:48 INFO Executor: Finished task 0.0 in stage 60.0 (TID 195). 1632 bytes result sent to driver
25/10/11 20:54:48 INFO TaskSetManager: Finished task 0.0 in stage 60.0 (TID 195) in 925 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:48 INFO TaskSchedulerImpl: Removed TaskSet 60.0, whose tasks have all completed, from pool 
25/10/11 20:54:48 INFO DAGScheduler: ShuffleMapStage 60 (distinct at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:173) finished in 0.930 s
25/10/11 20:54:48 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:48 INFO DAGScheduler: running: Set()
25/10/11 20:54:48 INFO DAGScheduler: waiting: Set(ResultStage 61)
25/10/11 20:54:48 INFO DAGScheduler: failed: Set()
25/10/11 20:54:48 INFO DAGScheduler: Submitting ResultStage 61 (PythonRDD[121] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174), which has no missing parents
25/10/11 20:54:48 INFO MemoryStore: Block broadcast_44 stored as values in memory (estimated size 12.2 KiB, free 294.9 MiB)
25/10/11 20:54:48 INFO MemoryStore: Block broadcast_44_piece0 stored as bytes in memory (estimated size 6.9 KiB, free 294.9 MiB)
25/10/11 20:54:48 INFO BlockManagerInfo: Added broadcast_44_piece0 in memory on 10.255.255.254:38093 (size: 6.9 KiB, free: 295.7 MiB)
25/10/11 20:54:48 INFO SparkContext: Created broadcast 44 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:48 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 61 (PythonRDD[121] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:48 INFO TaskSchedulerImpl: Adding task set 61.0 with 8 tasks resource profile 0
25/10/11 20:54:48 INFO TaskSetManager: Starting task 0.0 in stage 61.0 (TID 203) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 1.0 in stage 61.0 (TID 204) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 2.0 in stage 61.0 (TID 205) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 3.0 in stage 61.0 (TID 206) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 4.0 in stage 61.0 (TID 207) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 5.0 in stage 61.0 (TID 208) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 6.0 in stage 61.0 (TID 209) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO TaskSetManager: Starting task 7.0 in stage 61.0 (TID 210) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:48 INFO Executor: Running task 7.0 in stage 61.0 (TID 210)
25/10/11 20:54:48 INFO Executor: Running task 2.0 in stage 61.0 (TID 205)
25/10/11 20:54:48 INFO Executor: Running task 6.0 in stage 61.0 (TID 209)
25/10/11 20:54:48 INFO Executor: Running task 3.0 in stage 61.0 (TID 206)
25/10/11 20:54:48 INFO Executor: Running task 1.0 in stage 61.0 (TID 204)
25/10/11 20:54:48 INFO Executor: Running task 4.0 in stage 61.0 (TID 207)
25/10/11 20:54:48 INFO Executor: Running task 0.0 in stage 61.0 (TID 203)
25/10/11 20:54:48 INFO Executor: Running task 5.0 in stage 61.0 (TID 208)
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (367.4 KiB) non-empty blocks including 8 (367.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (363.2 KiB) non-empty blocks including 8 (363.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (371.7 KiB) non-empty blocks including 8 (371.7 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (350.6 KiB) non-empty blocks including 8 (350.6 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (354.8 KiB) non-empty blocks including 8 (354.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (354.8 KiB) non-empty blocks including 8 (354.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (371.7 KiB) non-empty blocks including 8 (371.7 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Getting 8 (363.2 KiB) non-empty blocks including 8 (363.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:48 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO PythonRunner: Times: total = 84, boot = -966, init = 1020, finish = 30
25/10/11 20:54:49 INFO Executor: Finished task 1.0 in stage 61.0 (TID 204). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 1.0 in stage 61.0 (TID 204) in 94 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 98, boot = -45, init = 103, finish = 40
25/10/11 20:54:49 INFO PythonRunner: Times: total = 103, boot = -155, init = 223, finish = 35
25/10/11 20:54:49 INFO Executor: Finished task 7.0 in stage 61.0 (TID 210). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO Executor: Finished task 4.0 in stage 61.0 (TID 207). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 7.0 in stage 61.0 (TID 210) in 113 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:49 INFO TaskSetManager: Finished task 4.0 in stage 61.0 (TID 207) in 114 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 107, boot = -972, init = 1025, finish = 54
25/10/11 20:54:49 INFO Executor: Finished task 6.0 in stage 61.0 (TID 209). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 6.0 in stage 61.0 (TID 209) in 117 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 112, boot = -977, init = 1042, finish = 47
25/10/11 20:54:49 INFO PythonRunner: Times: total = 112, boot = -960, init = 1018, finish = 54
25/10/11 20:54:49 INFO Executor: Finished task 3.0 in stage 61.0 (TID 206). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO Executor: Finished task 0.0 in stage 61.0 (TID 203). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 3.0 in stage 61.0 (TID 206) in 121 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:49 INFO TaskSetManager: Finished task 0.0 in stage 61.0 (TID 203) in 121 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 115, boot = -33, init = 97, finish = 51
25/10/11 20:54:49 INFO Executor: Finished task 2.0 in stage 61.0 (TID 205). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 2.0 in stage 61.0 (TID 205) in 126 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 132, boot = -167, init = 243, finish = 56
25/10/11 20:54:49 INFO Executor: Finished task 5.0 in stage 61.0 (TID 208). 2055 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 5.0 in stage 61.0 (TID 208) in 141 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 61.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO DAGScheduler: ResultStage 61 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174) finished in 0.150 s
25/10/11 20:54:49 INFO DAGScheduler: Job 29 is finished. Cancelling potential speculative or zombie tasks for this job
25/10/11 20:54:49 INFO TaskSchedulerImpl: Killing all running tasks in stage 61: Stage finished
25/10/11 20:54:49 INFO DAGScheduler: Job 29 finished: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:174, took 1.086163 s
  > 7. Distinct: 63,322 products, 163,024 users
25/10/11 20:54:49 INFO SparkContext: Starting job: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181
25/10/11 20:54:49 INFO DAGScheduler: Registering RDD 123 (groupByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:179) as input to shuffle 16
25/10/11 20:54:49 INFO DAGScheduler: Got job 30 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181) with 8 output partitions
25/10/11 20:54:49 INFO DAGScheduler: Final stage: ResultStage 64 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181)
25/10/11 20:54:49 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 63)
25/10/11 20:54:49 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 63)
25/10/11 20:54:49 INFO DAGScheduler: Submitting ShuffleMapStage 63 (PairwiseRDD[123] at groupByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:179), which has no missing parents
25/10/11 20:54:49 INFO MemoryStore: Block broadcast_45 stored as values in memory (estimated size 14.8 KiB, free 294.9 MiB)
25/10/11 20:54:49 INFO MemoryStore: Block broadcast_45_piece0 stored as bytes in memory (estimated size 8.5 KiB, free 294.9 MiB)
25/10/11 20:54:49 INFO BlockManagerInfo: Added broadcast_45_piece0 in memory on 10.255.255.254:38093 (size: 8.5 KiB, free: 295.7 MiB)
25/10/11 20:54:49 INFO SparkContext: Created broadcast 45 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:49 INFO DAGScheduler: Submitting 8 missing tasks from ShuffleMapStage 63 (PairwiseRDD[123] at groupByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:179) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:49 INFO TaskSchedulerImpl: Adding task set 63.0 with 8 tasks resource profile 0
25/10/11 20:54:49 INFO TaskSetManager: Starting task 0.0 in stage 63.0 (TID 211) (10.255.255.254, executor driver, partition 0, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 1.0 in stage 63.0 (TID 212) (10.255.255.254, executor driver, partition 1, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 2.0 in stage 63.0 (TID 213) (10.255.255.254, executor driver, partition 2, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 3.0 in stage 63.0 (TID 214) (10.255.255.254, executor driver, partition 3, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 4.0 in stage 63.0 (TID 215) (10.255.255.254, executor driver, partition 4, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 5.0 in stage 63.0 (TID 216) (10.255.255.254, executor driver, partition 5, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 6.0 in stage 63.0 (TID 217) (10.255.255.254, executor driver, partition 6, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 7.0 in stage 63.0 (TID 218) (10.255.255.254, executor driver, partition 7, PROCESS_LOCAL, 9082 bytes) 
25/10/11 20:54:49 INFO Executor: Running task 3.0 in stage 63.0 (TID 214)
25/10/11 20:54:49 INFO Executor: Running task 5.0 in stage 63.0 (TID 216)
25/10/11 20:54:49 INFO Executor: Running task 2.0 in stage 63.0 (TID 213)
25/10/11 20:54:49 INFO Executor: Running task 6.0 in stage 63.0 (TID 217)
25/10/11 20:54:49 INFO Executor: Running task 7.0 in stage 63.0 (TID 218)
25/10/11 20:54:49 INFO Executor: Running task 4.0 in stage 63.0 (TID 215)
25/10/11 20:54:49 INFO Executor: Running task 1.0 in stage 63.0 (TID 212)
25/10/11 20:54:49 INFO Executor: Running task 0.0 in stage 63.0 (TID 211)
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_1 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_7 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_2 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_6 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_5 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_4 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_0 locally
25/10/11 20:54:49 INFO BlockManager: Found block rdd_96_3 locally
25/10/11 20:54:49 INFO PythonRunner: Times: total = 59, boot = -209, init = 258, finish = 10
25/10/11 20:54:49 INFO Executor: Finished task 7.0 in stage 63.0 (TID 218). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 7.0 in stage 63.0 (TID 218) in 90 ms on 10.255.255.254 (executor driver) (1/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 89, boot = -207, init = 278, finish = 18
25/10/11 20:54:49 INFO Executor: Finished task 2.0 in stage 63.0 (TID 213). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO PythonRunner: Times: total = 78, boot = -64, init = 124, finish = 18
25/10/11 20:54:49 INFO Executor: Finished task 0.0 in stage 63.0 (TID 211). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO PythonRunner: Times: total = 91, boot = -221, init = 289, finish = 23
25/10/11 20:54:49 INFO TaskSetManager: Finished task 2.0 in stage 63.0 (TID 213) in 115 ms on 10.255.255.254 (executor driver) (2/8)
25/10/11 20:54:49 INFO TaskSetManager: Finished task 0.0 in stage 63.0 (TID 211) in 116 ms on 10.255.255.254 (executor driver) (3/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 89, boot = -63, init = 129, finish = 23
25/10/11 20:54:49 INFO Executor: Finished task 1.0 in stage 63.0 (TID 212). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 1.0 in stage 63.0 (TID 212) in 122 ms on 10.255.255.254 (executor driver) (4/8)
25/10/11 20:54:49 INFO Executor: Finished task 4.0 in stage 63.0 (TID 215). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 4.0 in stage 63.0 (TID 215) in 123 ms on 10.255.255.254 (executor driver) (5/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 88, boot = -200, init = 269, finish = 19
25/10/11 20:54:49 INFO Executor: Finished task 6.0 in stage 63.0 (TID 217). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 6.0 in stage 63.0 (TID 217) in 127 ms on 10.255.255.254 (executor driver) (6/8)
25/10/11 20:54:49 INFO PythonRunner: Times: total = 96, boot = -82, init = 151, finish = 27
25/10/11 20:54:49 INFO Executor: Finished task 5.0 in stage 63.0 (TID 216). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO PythonRunner: Times: total = 101, boot = -60, init = 138, finish = 23
25/10/11 20:54:49 INFO TaskSetManager: Finished task 5.0 in stage 63.0 (TID 216) in 133 ms on 10.255.255.254 (executor driver) (7/8)
25/10/11 20:54:49 INFO Executor: Finished task 3.0 in stage 63.0 (TID 214). 1589 bytes result sent to driver
25/10/11 20:54:49 INFO TaskSetManager: Finished task 3.0 in stage 63.0 (TID 214) in 136 ms on 10.255.255.254 (executor driver) (8/8)
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 63.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO DAGScheduler: ShuffleMapStage 63 (groupByKey at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:179) finished in 0.141 s
25/10/11 20:54:49 INFO DAGScheduler: looking for newly runnable stages
25/10/11 20:54:49 INFO DAGScheduler: running: Set()
25/10/11 20:54:49 INFO DAGScheduler: waiting: Set(ResultStage 64)
25/10/11 20:54:49 INFO DAGScheduler: failed: Set()
25/10/11 20:54:49 INFO DAGScheduler: Submitting ResultStage 64 (PythonRDD[126] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181), which has no missing parents
25/10/11 20:54:49 INFO MemoryStore: Block broadcast_46 stored as values in memory (estimated size 13.4 KiB, free 294.9 MiB)
25/10/11 20:54:49 INFO MemoryStore: Block broadcast_46_piece0 stored as bytes in memory (estimated size 7.5 KiB, free 294.9 MiB)
25/10/11 20:54:49 INFO BlockManagerInfo: Added broadcast_46_piece0 in memory on 10.255.255.254:38093 (size: 7.5 KiB, free: 295.7 MiB)
25/10/11 20:54:49 INFO SparkContext: Created broadcast 46 from broadcast at DAGScheduler.scala:1585
25/10/11 20:54:49 INFO DAGScheduler: Submitting 8 missing tasks from ResultStage 64 (PythonRDD[126] at count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5, 6, 7))
25/10/11 20:54:49 INFO TaskSchedulerImpl: Adding task set 64.0 with 8 tasks resource profile 0
25/10/11 20:54:49 INFO TaskSetManager: Starting task 0.0 in stage 64.0 (TID 219) (10.255.255.254, executor driver, partition 0, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 1.0 in stage 64.0 (TID 220) (10.255.255.254, executor driver, partition 1, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 2.0 in stage 64.0 (TID 221) (10.255.255.254, executor driver, partition 2, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 3.0 in stage 64.0 (TID 222) (10.255.255.254, executor driver, partition 3, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 4.0 in stage 64.0 (TID 223) (10.255.255.254, executor driver, partition 4, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 5.0 in stage 64.0 (TID 224) (10.255.255.254, executor driver, partition 5, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 6.0 in stage 64.0 (TID 225) (10.255.255.254, executor driver, partition 6, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO TaskSetManager: Starting task 7.0 in stage 64.0 (TID 226) (10.255.255.254, executor driver, partition 7, NODE_LOCAL, 8817 bytes) 
25/10/11 20:54:49 INFO Executor: Running task 5.0 in stage 64.0 (TID 224)
25/10/11 20:54:49 INFO Executor: Running task 1.0 in stage 64.0 (TID 220)
25/10/11 20:54:49 INFO Executor: Running task 3.0 in stage 64.0 (TID 222)
25/10/11 20:54:49 INFO Executor: Running task 4.0 in stage 64.0 (TID 223)
25/10/11 20:54:49 INFO Executor: Running task 6.0 in stage 64.0 (TID 225)
25/10/11 20:54:49 INFO Executor: Running task 7.0 in stage 64.0 (TID 226)
25/10/11 20:54:49 INFO Executor: Running task 0.0 in stage 64.0 (TID 219)
25/10/11 20:54:49 INFO Executor: Running task 2.0 in stage 64.0 (TID 221)
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (27.1 KiB) non-empty blocks including 8 (27.1 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (25.2 KiB) non-empty blocks including 8 (25.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (23.7 KiB) non-empty blocks including 8 (23.7 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (25.8 KiB) non-empty blocks including 8 (25.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (23.2 KiB) non-empty blocks including 8 (23.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (25.8 KiB) non-empty blocks including 8 (25.8 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (25.2 KiB) non-empty blocks including 8 (25.2 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 0 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Getting 8 (24.4 KiB) non-empty blocks including 8 (24.4 KiB) local and 0 (0.0 B) host-local and 0 (0.0 B) push-merged-local and 0 (0.0 B) remote blocks
25/10/11 20:54:49 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 1 ms
25/10/11 20:54:49 ERROR Executor: Exception in task 5.0 in stage 64.0 (TID 224)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 6.0 in stage 64.0 (TID 225)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 1.0 in stage 64.0 (TID 220)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 7.0 in stage 64.0 (TID 226)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 0.0 in stage 64.0 (TID 219)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 4.0 in stage 64.0 (TID 223)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR Executor: Exception in task 2.0 in stage 64.0 (TID 221)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 WARN TaskSetManager: Lost task 1.0 in stage 64.0 (TID 220) (10.255.255.254 executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

25/10/11 20:54:49 ERROR Executor: Exception in task 3.0 in stage 64.0 (TID 222)
org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
25/10/11 20:54:49 ERROR TaskSetManager: Task 1 in stage 64.0 failed 1 times; aborting job
25/10/11 20:54:49 INFO TaskSetManager: Lost task 0.0 in stage 64.0 (TID 219) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 1]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO TaskSetManager: Lost task 5.0 in stage 64.0 (TID 224) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 2]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO TaskSchedulerImpl: Cancelling stage 64
25/10/11 20:54:49 INFO TaskSchedulerImpl: Killing all running tasks in stage 64: Stage cancelled: Job aborted due to stage failure: Task 1 in stage 64.0 failed 1 times, most recent failure: Lost task 1.0 in stage 64.0 (TID 220) (10.255.255.254 executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

Driver stacktrace:
25/10/11 20:54:49 INFO TaskSetManager: Lost task 6.0 in stage 64.0 (TID 225) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 3]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO DAGScheduler: ResultStage 64 (count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181) failed in 0.131 s due to Job aborted due to stage failure: Task 1 in stage 64.0 failed 1 times, most recent failure: Lost task 1.0 in stage 64.0 (TID 220) (10.255.255.254 executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

Driver stacktrace:
25/10/11 20:54:49 INFO TaskSetManager: Lost task 7.0 in stage 64.0 (TID 226) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 4]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO TaskSetManager: Lost task 4.0 in stage 64.0 (TID 223) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 5]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO TaskSetManager: Lost task 2.0 in stage 64.0 (TID 221) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 6]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO TaskSetManager: Lost task 3.0 in stage 64.0 (TID 222) on 10.255.255.254, executor driver: org.apache.spark.api.python.PythonException (Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.
) [duplicate 7]
25/10/11 20:54:49 INFO TaskSchedulerImpl: Removed TaskSet 64.0, whose tasks have all completed, from pool 
25/10/11 20:54:49 INFO DAGScheduler: Job 30 failed: count at /home/arnav/ECommerce_Project/unified_ecommerce_analysis.py:181, took 0.279141 s
Traceback (most recent call last):
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 181, in <module>
    print_result("8-9. GroupByKey + MapValues", f"{user_purchase_stats.count():,} user purchase profiles")
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in count
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2291, in sum
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2044, in fold
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 1833, in collect
  File "/usr/local/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/java_gateway.py", line 1322, in __call__
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/errors/exceptions/captured.py", line 179, in deco
  File "/usr/local/spark/python/lib/py4j-0.10.9.7-src.zip/py4j/protocol.py", line 326, in get_return_value
py4j.protocol.Py4JJavaError: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 64.0 failed 1 times, most recent failure: Lost task 1.0 in stage 64.0 (TID 220) (10.255.255.254 executor driver): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2458)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1049)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:410)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1048)
	at org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:195)
	at org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1247, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 1237, in process
    out_iter = func(split_index, iterator)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 5434, in pipeline_func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 840, in func
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <lambda>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 2316, in <genexpr>
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/util.py", line 83, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/rdd.py", line 4260, in map_values_fn
  File "/home/arnav/ECommerce_Project/unified_ecommerce_analysis.py", line 180, in <lambda>
    .mapValues(lambda prices: (len(list(prices)), sum(prices)))
                                                  ^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/utils.py", line 174, in wrapped
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 866, in sum
    return _invoke_function_over_columns("sum", col)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/functions.py", line 105, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
                                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/column.py", line 65, in _to_java_column
    raise PySparkTypeError(
pyspark.errors.exceptions.base.PySparkTypeError: [NOT_COLUMN_OR_STR] Argument `col` should be a Column or str, got ResultIterable.

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:784)
	at org.apache.spark.api.python.PythonRunner$$anon$3.read(PythonRunner.scala:766)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.InterruptibleIterator.foreach(InterruptibleIterator.scala:28)
	at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)
	at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)
	at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)
	at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)
	at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)
	at org.apache.spark.InterruptibleIterator.to(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)
	at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)
	at org.apache.spark.InterruptibleIterator.toBuffer(InterruptibleIterator.scala:28)
	at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)
	at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)
	at org.apache.spark.InterruptibleIterator.toArray(InterruptibleIterator.scala:28)
	at org.apache.spark.rdd.RDD.$anonfun$collect$2(RDD.scala:1049)
	at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2433)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more

25/10/11 20:54:49 INFO SparkContext: Invoking stop() from shutdown hook
25/10/11 20:54:49 INFO SparkContext: SparkContext is stopping with exitCode 0.
25/10/11 20:54:49 INFO SparkUI: Stopped Spark web UI at http://10.255.255.254:4040
25/10/11 20:54:49 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
25/10/11 20:54:49 INFO MemoryStore: MemoryStore cleared
25/10/11 20:54:49 INFO BlockManager: BlockManager stopped
25/10/11 20:54:49 INFO BlockManagerMaster: BlockManagerMaster stopped
25/10/11 20:54:49 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
25/10/11 20:54:49 INFO SparkContext: Successfully stopped SparkContext
25/10/11 20:54:49 INFO ShutdownHookManager: Shutdown hook called
25/10/11 20:54:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-6b991b4a-c14d-47be-a4d5-389652db7e57
25/10/11 20:54:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-585e8a49-4eb0-46b3-a566-2ca30424c25f
25/10/11 20:54:49 INFO ShutdownHookManager: Deleting directory /tmp/spark-6b991b4a-c14d-47be-a4d5-389652db7e57/pyspark-d3ed14d2-c090-49a0-a963-f7d2a96e0723
